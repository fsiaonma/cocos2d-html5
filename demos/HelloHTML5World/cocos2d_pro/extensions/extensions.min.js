cc.CONTROL_EVENT_TOTAL_NUMBER=9,cc.CONTROL_EVENT_TOUCH_DOWN=1,cc.CONTROL_EVENT_TOUCH_DRAG_INSIDE=2,cc.CONTROL_EVENT_TOUCH_DRAG_OUTSIDE=4,cc.CONTROL_EVENT_TOUCH_DRAG_ENTER=8,cc.CONTROL_EVENT_TOUCH_DRAG_EXIT=16,cc.CONTROL_EVENT_TOUCH_UP_INSIDE=32,cc.CONTROL_EVENT_TOUCH_UP_OUTSIDE=64,cc.CONTROL_EVENT_TOUCH_CANCEL=128,cc.CONTROL_EVENT_VALUECHANGED=256,cc.CONTROL_STATE_NORMAL=1,cc.CONTROL_STATE_HIGHLIGHTED=2,cc.CONTROL_STATE_DISABLED=4,cc.CONTROL_STATE_SELECTED=8,cc.CONTROL_STATE_INITIAL=8,cc.Control=cc.Layer.extend({RGBAProtocol:!0,_opacity:0,_color:null,_opacityModifyRGB:!1,isOpacityModifyRGB:function(){return this._opacityModifyRGB},setOpacityModifyRGB:function(e){this._opacityModifyRGB=e;var t=this.getChildren();for(var n=0;n<t.length;n++){var r=t[n];r&&r.RGBAProtocol&&r.setOpacityModifyRGB(e)}},_defaultTouchPriority:0,getDefaultTouchPriority:function(){return this._defaultTouchPriority},setDefaultTouchPriority:function(e){this._defaultTouchPriority=e},_state:cc.CONTROL_STATE_NORMAL,getState:function(){return this._state},_enabled:!1,_selected:!1,_highlighted:!1,_dispatchTable:{},setOpacity:function(e){this._opacity=e;var t=this.getChildren();for(var n=0;n<t.length;n++){var r=t[n];r&&r.RGBAProtocol&&r.setOpacity(e)}},getOpacity:function(){return this._opacity},getColor:function(){return this._color},setColor:function(e){this._color=e;var t=this.getChildren();for(var n=0;n<t.length;n++){var r=t[n];r&&r.RGBAProtocol&&r.setColor(e)}},setEnabled:function(e){this._enabled=e},isEnabled:function(){return this._enabled},setSelected:function(e){this._selected=e},isSelected:function(){return this._selected},setHighlighted:function(e){this._highlighted=e},isHighlighted:function(){return this._highlighted},ctor:function(){this._super(),this._dispatchTable={},this._color=cc.white()},init:function(){return this._super()?(this._state=cc.CONTROL_STATE_NORMAL,this._enabled=!0,this._selected=!1,this._highlighted=!1,this._defaultTouchPriority=1,this.setDefaultTouchPriority(this._defaultTouchPriority),this._dispatchTable={},!0):!1},onEnter:function(){this._super()},onExit:function(){this._super()},registerWithTouchDispatcher:function(){cc.Director.getInstance().getTouchDispatcher().addTargetedDelegate(this,cc.MENU_HANDLER_PRIORITY,!0)},sendActionsForControlEvents:function(e){for(var t=0;t<cc.CONTROL_EVENT_TOTAL_NUMBER;t++)if(e&1<<t){var n=this._dispatchListforControlEvent(1<<t);for(var r=0;r<n.length;r++)n[r].invoke(this)}},addTargetWithActionForControlEvents:function(e,t,n){for(var r=0;r<cc.CONTROL_EVENT_TOTAL_NUMBER;r++)n&1<<r&&this.addTargetWithActionForControlEvent(e,t,1<<r)},removeTargetWithActionForControlEvents:function(e,t,n){for(var r=0;r<cc.CONTROL_EVENT_TOTAL_NUMBER;r++)n&1<<r&&this.removeTargetWithActionForControlEvent(e,t,1<<r)},getTouchLocation:function(e){var t=e.getLocation();return t=this.getParent().convertToNodeSpace(t),t},isTouchInside:function(e){var t=this.getTouchLocation(e),n=this.getBoundingBox();return cc.Rect.CCRectContainsPoint(n,t)},_invocationWithTargetAndActionForControlEvent:function(e,t,n){},_dispatchListforControlEvent:function(e){e=e.toString();if(this._dispatchTable.hasOwnProperty(e))return this._dispatchTable[e];var t=[];return this._dispatchTable[e]=t,t},addTargetWithActionForControlEvent:function(e,t,n){var r=new cc.Invocation(e,t,n),i=this._dispatchListforControlEvent(n);i.push(r)},removeTargetWithActionForControlEvent:function(e,t,n){var r=this._dispatchListforControlEvent(n),i=!0;if(!e&&!t)r.length=0;else for(var s=0;s<r.length;s++){var o=r[s],u=!0;e&&(u=e==o.getTarget()),t&&(u=u&&t==o.getAction()),u&&cc.ArrayRemoveObject(r,o)}}}),cc.Control.create=function(){var e=new cc.Control;return e&&e.init()?e:null};cc.CONTROL_ZOOM_ACTION_TAG=3435855873,cc.ControlButton=cc.Control.extend({_adjustBackgroundImage:!1,_zoomOnTouchDown:!1,_preferredSize:new cc.Size(0,0),_labelAnchorPoint:new cc.Point(0,0),_currentTitle:"",_currentTitleColor:cc.white(),_titleLabel:null,_backgroundSprite:null,_opacity:0,_pushed:!1,_titleDispatchTable:null,_titleColorDispatchTable:null,_titleLabelDispatchTable:null,_backgroundSpriteDispatchTable:null,_marginV:0,_marginH:0,ctor:function(){this._super(),this._preferredSize=new cc.Size(0,0),this._labelAnchorPoint=new cc.Point(0,0),this._currentTitleColor=cc.white(),this._titleDispatchTable={},this._titleColorDispatchTable={},this._titleLabelDispatchTable={},this._backgroundSpriteDispatchTable={}},init:function(e){return e!=null&&e==1?this._super():this.initWithLabelAndBackgroundSprite(cc.LabelTTF.create("","Helvetica",12),cc.Scale9Sprite.create())},needsLayout:function(){this._titleLabel.setVisible(!1),this._backgroundSprite.setVisible(!1),this.setLabelAnchorPoint(this.m_labelAnchorPoint),this._currentTitle=this.getTitleForState(this._state),this._currentTitleColor=this.getTitleColorForState(this._state),this._titleLabel=this.getTitleLabelForState(this._state);var e=this._titleLabel;e&&e.setString&&e.setString(this._currentTitle),this._titleLabel&&this._titleLabel.RGBAProtocol&&this._titleLabel.setColor(this._currentTitleColor),this._titleLabel.setPosition(cc.p(this.getContentSize().width/2,this.getContentSize().height/2)),this._backgroundSprite=this.getBackgroundSpriteForState(this._state),this._backgroundSprite.setPosition(cc.p(this.getContentSize().width/2,this.getContentSize().height/2));var t=this._titleLabel.getBoundingBox().size;if(this._adjustBackgroundImage)this._backgroundSprite.setContentSize(cc.SizeMake(t.width+this._marginH*2,t.height+this._marginV*2));else{var n=this._backgroundSprite.getPreferredSize();n.width<=0&&(n.width=t.width),n.height<=0&&(n.height=t.height),this._backgroundSprite.setContentSize(n)}var r=cc.ControlUtils.CCRectUnion(this._titleLabel.getBoundingBox(),this._backgroundSprite.getBoundingBox());this.setContentSize(cc.SizeMake(r.size.width,r.size.height)),this._titleLabel.setPosition(cc.p(this.getContentSize().width/2,this.getContentSize().height/2)),this._backgroundSprite.setPosition(cc.p(this.getContentSize().width/2,this.getContentSize().height/2)),this._titleLabel.setVisible(!0),this._backgroundSprite.setVisible(!0)},initWithLabelAndBackgroundSprite:function(e,t){if(this.init(!0)){cc.Assert(e!=null,"node must not be nil"),cc.Assert(e!=null||e.RGBAProtocol||t!=null,""),this.setTouchEnabled(!0),this._pushed=!1,this._zoomOnTouchDown=!0,this._state=cc.CONTROL_STATE_INITIAL,this._currentTitle=null,this._adjustBackgroundImage=!0,this._zoomOnTouchDown=!0,this.ignoreAnchorPointForPosition(!1),this.setAnchorPoint(cc.p(.5,.5)),this._titleLabel=e,this._backgroundSprite=t,this._titleDispatchTable={},this._titleColorDispatchTable={},this._titleLabelDispatchTable={},this._backgroundSpriteDispatchTable={},this.setColor(cc.c3(255,255,255)),this.setOpacity(255),this.setOpacityModifyRGB(!0);var n=e.getString();return this.setTitleForState(n,cc.CONTROL_STATE_NORMAL),this.setTitleColorForState(e.getColor(),cc.CONTROL_STATE_NORMAL),this.setTitleLabelForState(e,cc.CONTROL_STATE_NORMAL),this.setBackgroundSpriteForState(t,cc.CONTROL_STATE_NORMAL),this._state=cc.CONTROL_STATE_NORMAL,this._marginH=24,this._marginV=12,this.m_labelAnchorPoint=new cc.Point(.5,.5),this.needsLayout(),!0}return!1},initWithTitleAndFontNameAndFontSize:function(e,t,n){var r=cc.LabelTTF.create(e,t,n);return this.initWithLabelAndBackgroundSprite(r,cc.Scale9Sprite.create())},initWithBackgroundSprite:function(e){var t=cc.LabelTTF.create("","Arial",30);return this.initWithLabelAndBackgroundSprite(t,e)},getAdjustBackgroundImage:function(){return this._adjustBackgroundImage},setAdjustBackgroundImage:function(e){this._adjustBackgroundImage=e,this.needsLayout()},getZoomOnTouchDown:function(){return this._zoomOnTouchDown},setZoomOnTouchDown:function(e){return this._zoomOnTouchDown=e},getPreferredSize:function(){return this._preferredSize},setPreferredSize:function(e){if(e.width==0&&e.height==0)this._adjustBackgroundImage=!0;else{this._adjustBackgroundImage=!1;for(var t in this._backgroundSpriteDispatchTable)this._backgroundSpriteDispatchTable[t].setPreferredSize(e);this._preferredSize=e}this.needsLayout()},getLabelAnchorPoint:function(){return this._labelAnchorPoint},setLabelAnchorPoint:function(e){this.m_labelAnchorPoint=e,this._titleLabel.setAnchorPoint(e)},getCurrentTitle:function(){return this._currentTitle},getCurrentTitleColor:function(){return this._currentTitleColor},getOpacity:function(){return this._opacity},setOpacity:function(e){this._opacity=e;var t=this.getChildren();for(var n=0;n<t.length;n++)t[n]&&t[n].RGBAProtocol&&t[n].setOpacity(e);for(var r in this._backgroundSpriteDispatchTable)this._backgroundSpriteDispatchTable[r].setOpacity(e)},getIsPushed:function(){return this._pushed},getVerticalMargin:function(){return this._marginV},getHorizontalOrigin:function(){return this._marginH},setMargins:function(e,t){this._marginV=t,this._marginH=e,this.needsLayout()},setEnabled:function(e){this._super(e),this.needsLayout()},setSelected:function(e){this._super(e),this.needsLayout()},setHighlighted:function(e){this._super(e);var t=this.getActionByTag(cc.CONTROL_ZOOM_ACTION_TAG);t&&this.stopAction(t),this.needsLayout();if(this._zoomOnTouchDown){var n=this.isHighlighted()&&this.isEnabled()&&!this.isSelected()?1.1:1,r=cc.ScaleTo.create(.05,n);r.setTag(cc.CONTROL_ZOOM_ACTION_TAG),this.runAction(r)}},onTouchBegan:function(e,t){return!this.isTouchInside(e)||!this.isEnabled()?!1:(this._state=cc.CONTROL_STATE_HIGHLIGHTED,this._pushed=!0,this.setHighlighted(!0),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DOWN),!0)},onTouchMoved:function(e,t){if(!this._enabled||!this._pushed||this._selected){this._highlighted&&this.setHighlighted(!1);return}var n=this.isTouchInside(e);n&&!this._highlighted?(this._state=cc.CONTROL_STATE_HIGHLIGHTED,this.setHighlighted(!0),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_ENTER)):n&&this._highlighted?this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_INSIDE):!n&&this._highlighted?(this._state=cc.CONTROL_STATE_NORMAL,this.setHighlighted(!1),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_EXIT)):!n&&!this._highlighted&&this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_OUTSIDE)},onTouchEnded:function(e,t){this._state=cc.CONTROL_STATE_NORMAL,this._pushed=!1,this.setHighlighted(!1),this.isTouchInside(e)?this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_UP_INSIDE):this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_UP_OUTSIDE)},onTouchCancelled:function(e,t){this._state=cc.CONTROL_STATE_NORMAL,this._pushed=!1,this.setHighlighted(!1),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_CANCEL)},getTitleForState:function(e){return this._titleDispatchTable.hasOwnProperty(e)&&this._titleDispatchTable[e]?this._titleDispatchTable[e]:this._titleDispatchTable[cc.CONTROL_STATE_NORMAL]},setTitleForState:function(e,t){e?this._titleDispatchTable[t]=e:this._titleDispatchTable[t]="",this.getState()==t&&this.needsLayout()},getTitleColorForState:function(e){return this._titleColorDispatchTable.hasOwnProperty(e)&&this._titleColorDispatchTable[e]?this._titleColorDispatchTable[e]:this._titleColorDispatchTable[cc.CONTROL_STATE_NORMAL]},setTitleColorForState:function(e,t){this._titleColorDispatchTable[t]=e,this.getState()==t&&this.needsLayout()},getTitleLabelForState:function(e){return this._titleLabelDispatchTable.hasOwnProperty(e)&&this._titleLabelDispatchTable[e]?this._titleLabelDispatchTable[e]:this._titleLabelDispatchTable[cc.CONTROL_STATE_NORMAL]},setTitleLabelForState:function(e,t){if(this._titleLabelDispatchTable.hasOwnProperty(t)){var n=this._titleLabelDispatchTable[t];n&&this.removeChild(n,!0)}this._titleLabelDispatchTable[t]=e,e.setVisible(!1),e.setAnchorPoint(cc.p(.5,.5)),this.addChild(e,1),this.getState()==t&&this.needsLayout()},setTitleTTFForState:function(e,t){var n=this.getTitleForState(t);n||(n=""),this.setTitleLabelForState(cc.LabelTTF.create(n,e,12),t)},getTitleTTFForState:function(e){var t=this.getTitleLabelForState(e);return t!=null&&t instanceof cc.LabelTTF?t.getFontName():""},setTitleTTFSizeForState:function(e,t){var n=this.getTitleLabelForState(t);n!=null&&n instanceof cc.LabelTTF&&n.setFontSize(e)},getTitleTTFSizeForState:function(e){var t=this.getTitleLabelForState(e);return t!=null&&t instanceof cc.LabelTTF?t.getFontSize():0},setTitleBMFontForState:function(e,t){var n=this.getTitleForState(t);n||(n=""),this.setTitleLabelForState(cc.LabelBMFont.create(n,e),t)},getTitleBMFontForState:function(e){var t=this.getTitleLabelForState(e);return t!=null&&t instanceof cc.LabelBMFont?t.getFntFile():""},getBackgroundSpriteForState:function(e){return this._backgroundSpriteDispatchTable.hasOwnProperty(e)&&this._backgroundSpriteDispatchTable[e]?this._backgroundSpriteDispatchTable[e]:this._backgroundSpriteDispatchTable[cc.CONTROL_STATE_NORMAL]},setBackgroundSpriteForState:function(e,t){if(this._backgroundSpriteDispatchTable.hasOwnProperty(t)){var n=this._backgroundSpriteDispatchTable[t];n&&this.removeChild(n,!0)}this._backgroundSpriteDispatchTable[t]=e,e.setVisible(!1),e.setAnchorPoint(cc.p(.5,.5)),this.addChild(e),(this._preferredSize.width!=0||this._preferredSize.height!=0)&&e.setPreferredSize(this._preferredSize),this.getState()==t&&this.needsLayout()},setBackgroundSpriteFrameForState:function(e,t){var n=cc.Scale9Sprite.createWithSpriteFrame(e);this.setBackgroundSpriteForState(n,t)}}),cc.ControlButton.create=function(e,t){var n;if(arguments.length==0)return n=new cc.ControlButton,n&&n.init()?n:null;if(arguments.length==1)return n=new cc.ControlButton,n.initWithBackgroundSprite(arguments[0]),n;if(arguments.length==2)return n=new cc.ControlButton,n.initWithLabelAndBackgroundSprite(e,t),n;if(arguments.length==3)return n=new cc.ControlButton,n.initWithTitleAndFontNameAndFontSize(arguments[0],arguments[1],arguments[2]),n};cc.RGBA=function(e,t,n,r){this.r=e,this.g=t,this.b=n,this.a=r},cc.HSV=function(e,t,n){this.h=e,this.s=t,this.v=n},cc.ControlUtils={},cc.ControlUtils.addSpriteToTargetWithPosAndAnchor=function(e,t,n,r){var i=cc.Sprite.createWithSpriteFrameName(e);return i?(i.setPosition(n),i.setAnchorPoint(r),t.addChild(i),i):null},cc.ControlUtils.HSVfromRGB=function(e){var t=new cc.HSV,n,r,i;return n=e.r<e.g?e.r:e.g,n=n<e.b?n:e.b,r=e.r>e.g?e.r:e.g,r=r>e.b?r:e.b,t.v=r,i=r-n,r>0?(t.s=i/r,e.r>=r?t.h=(e.g-e.b)/i:e.g>=r?t.h=2+(e.b-e.r)/i:t.h=4+(e.r-e.g)/i,t.h*=60,t.h<0&&(t.h+=360),t):(t.s=0,t.h=-1,t)},cc.ControlUtils.RGBfromHSV=function(e){var t,n,r,i,s,o,u=new cc.RGBA;u.a=1;if(e.s<=0)return e.h?(u.r=0,u.g=0,u.b=0,u):(u.r=e.v,u.g=e.v,u.b=e.v,u);t=e.h,t>=360&&(t=0),t/=60,o=0|t,s=t-o,n=e.v*(1-e.s),r=e.v*(1-e.s*s),i=e.v*(1-e.s*(1-s));switch(o){case 0:u.r=e.v,u.g=i,u.b=n;break;case 1:u.r=r,u.g=e.v,u.b=n;break;case 2:u.r=n,u.g=e.v,u.b=i;break;case 3:u.r=n,u.g=r,u.b=e.v;break;case 4:u.r=i,u.g=n,u.b=e.v;break;case 5:default:u.r=e.v,u.g=n,u.b=r}return u},cc.ControlUtils.CCRectUnion=function(e,t){return cc.Rect.CCRectUnion(e,t)};cc.Invocation=cc.Class.extend({_action:null,_target:null,_controlEvent:null,ctor:function(e,t,n){this._target=e,this._action=t,this._controlEvent=n},getAction:function(){return this._action},getTarget:function(){return this._target},getControlEvent:function(){return this._controlEvent},invoke:function(e){this._target&&this._action&&(typeof this._action=="string"?this._target[this._action](e,this._controlEvent):this._action.call(this._target,e,this._controlEvent))}});cc.POSITIONS_CENTRE=0,cc.POSITIONS_TOP=1,cc.POSITIONS_LEFT=2,cc.POSITIONS_RIGHT=3,cc.POSITIONS_BOTTOM=4,cc.POSITIONS_TOPRIGHT=5,cc.POSITIONS_TOPLEFT=6,cc.POSITIONS_BOTTOMRIGHT=7,cc.POSITIONS_BOTTOMLEFT=8,cc.Scale9Sprite=cc.Node.extend({RGBAProtocol:!0,_spriteRect:null,_capInsetsInternal:null,_positionsAreDirty:!1,_scale9Image:null,_topLeft:null,_top:null,_topRight:null,_left:null,_centre:null,_right:null,_bottomLeft:null,_bottom:null,_bottomRight:null,_colorUnmodified:null,_opacityModifyRGB:!1,_originalSize:null,_preferredSize:null,_opacity:0,_color:null,_capInsets:null,_insetLeft:0,_insetTop:0,_insetRight:0,_insetBottom:0,_spritesGenerated:!1,_spriteFrameRotated:!1,_updateCapInset:function(){var e;this._insetLeft==0&&this._insetTop==0&&this._insetRight==0&&this._insetBottom==0?e=cc.RectZero():e=this._spriteFrameRotated?cc.RectMake(this._insetBottom,this._insetLeft,this._spriteRect.size.width-this._insetRight-this._insetLeft,this._spriteRect.size.height-this._insetTop-this._insetBottom):cc.RectMake(this._insetLeft,this._insetTop,this._spriteRect.size.width-this._insetLeft-this._insetRight,this._spriteRect.size.height-this._insetTop-this._insetBottom),this.setCapInsets(e)},_updatePositions:function(){if(!(this._topLeft&&this._topRight&&this._bottomRight&&this._bottomLeft&&this._centre))return;var e=this._contentSize,t=e.width-this._topLeft.getContentSize().width-this._topRight.getContentSize().width,n=e.height-this._topLeft.getContentSize().height-this._bottomRight.getContentSize().height,r=t/this._centre.getContentSize().width,i=n/this._centre.getContentSize().height;this._centre.setScaleX(r),this._centre.setScaleY(i);var s=this._centre.getContentSize().width*r,o=this._centre.getContentSize().height*i,u=this._bottomLeft.getContentSize().width,a=this._bottomLeft.getContentSize().height;this._bottomLeft.setAnchorPoint(cc.p(0,0)),this._bottomRight.setAnchorPoint(cc.p(0,0)),this._topLeft.setAnchorPoint(cc.p(0,0)),this._topRight.setAnchorPoint(cc.p(0,0)),this._left.setAnchorPoint(cc.p(0,0)),this._right.setAnchorPoint(cc.p(0,0)),this._top.setAnchorPoint(cc.p(0,0)),this._bottom.setAnchorPoint(cc.p(0,0)),this._centre.setAnchorPoint(cc.p(0,0)),this._bottomLeft.setPosition(cc.p(0,0)),this._bottomRight.setPosition(cc.p(u+s,0)),this._topLeft.setPosition(cc.p(0,a+o)),this._topRight.setPosition(cc.p(u+s,a+o)),this._left.setPosition(cc.p(0,a)),this._left.setScaleY(i),this._right.setPosition(cc.p(u+s,a)),this._right.setScaleY(i),this._bottom.setPosition(cc.p(u,0)),this._bottom.setScaleX(r),this._top.setPosition(cc.p(u,a+o)),this._top.setScaleX(r),this._centre.setPosition(cc.p(u,a))},ctor:function(){this._super(),this._spriteRect=cc.RectZero(),this._capInsetsInternal=cc.RectZero(),this._colorUnmodified=cc.white(),this._originalSize=new cc.Size(0,0),this._preferredSize=new cc.Size(0,0),this._color=cc.white(),this._opacity=255,this._capInsets=cc.RectZero()},getOriginalSize:function(){return this._originalSize},getPreferredSize:function(){return this._preferredSize},setPreferredSize:function(e){this.setContentSize(e),this._preferredSize=e},getOpacity:function(){return this._opacity},setOpacity:function(e){this._opacity=e},getColor:function(){return this._color},setColor:function(e){this._color=e;var t=this._scale9Image.getChildren();if(t&&t.length!=0)for(var n=0;n<t.length;n++)t[n]&&t[n].RGBAProtocol&&t[n].setColor(this._color)},getCapInsets:function(){return this._capInsets},setCapInsets:function(e){var t=this._contentSize;this.updateWithBatchNode(this._scale9Image,this._spriteRect,this._spriteFrameRotated,e),this.setContentSize(t)},getInsetLeft:function(){return this._insetLeft},setInsetLeft:function(e){this._insetLeft=e,this._updateCapInset()},getInsetTop:function(){return this._insetTop},setInsetTop:function(e){this._insetTop=e,this._updateCapInset()},getInsetRight:function(){return this._insetRight},setInsetRight:function(e){this._insetRight=e,this._updateCapInset()},getInsetBottom:function(){return this._insetBottom},setInsetBottom:function(e){this._insetBottom=e,this._updateCapInset()},setContentSize:function(e){this._super(e),this.m_positionsAreDirty=!0},visit:function(){this.m_positionsAreDirty&&(this._updatePositions(),this.m_positionsAreDirty=!1),this._super()},init:function(){return this.initWithBatchNode(null,cc.RectZero(),!1,cc.RectZero())},initWithBatchNode:function(e,t,n,r){return arguments.length==3&&(r=n,n=!1),e&&this.updateWithBatchNode(e,t,n,r),this.setAnchorPoint(cc.p(.5,.5)),this.m_positionsAreDirty=!0,!0},initWithFile:function(e,t,n){e instanceof cc.Rect?(e=arguments[1],n=arguments[0],t=cc.RectZero()):(t=t||cc.RectZero(),n=n||cc.RectZero()),cc.Assert(e!=null,"Invalid file for sprite");var r=cc.SpriteBatchNode.create(e,9);return this.initWithBatchNode(r,t,!1,n)},initWithSpriteFrame:function(e,t){t=t||cc.RectZero(),cc.Assert(e!=null,"Sprite frame must not be nil");var n=e.getTexture();cc.Assert(n!=null,"Texture must be not nil");var r=cc.SpriteBatchNode.createWithTexture(n,9);return this.initWithBatchNode(r,e.getRect(),cc.Browser.supportWebGL?e.isRotated():!1,t)},initWithSpriteFrameName:function(e,t){t=t||cc.RectZero(),cc.Assert(e!=null,"Invalid spriteFrameName for sprite");var n=cc.SpriteFrameCache.getInstance().getSpriteFrame(e);return cc.Assert(n!=null,"cc.SpriteFrame must be non-NULL"),n==null?!1:this.initWithSpriteFrame(n,t)},resizableSpriteWithCapInsets:function(e){var t=new cc.Scale9Sprite;return t&&t.initWithBatchNode(this._scale9Image,this._spriteRect,!1,e)?t:null},setOpacityModifyRGB:function(e){this._opacityModifyRGB=e;var t=this._scale9Image.getChildren();if(t)for(var n=0;n<t.length;n++)t[n].setOpacityModifyRGB(this._opacityModifyRGB)},isOpacityModifyRGB:function(){return this._opacityModifyRGB},updateWithBatchNode:function(e,t,n,r){var i=this.getOpacity(),s=this.getColor();this.removeAllChildren(!0),this._scale9Image!=e&&(this._scale9Image=e),this._scale9Image.removeAllChildren(!0),this._capInsets=r;var o=this._scale9Image.getTexture(),u=cc.RectZero();if(cc.Rect.CCRectEqualToRect(t,u))if(o instanceof cc.Texture2D){var a=o.getContentSize();t=cc.RectMake(0,0,a.width,a.height)}else t=cc.RectMake(0,0,o.width,o.height);this._spriteRect=t;var f=t.size;this._originalSize=new cc.Size(f.width,f.height),this._preferredSize=new cc.Size(f.width,f.height),this._capInsetsInternal=r||cc.RectZero();var l=f.width,c=f.height;cc.Rect.CCRectEqualToRect(this._capInsetsInternal,u)&&(this._capInsetsInternal=cc.rect(l/3,c/3,l/3,c/3));var h=this._capInsetsInternal.origin.x,p=this._capInsetsInternal.size.width,d=l-(h+p),v=this._capInsetsInternal.origin.y,m=this._capInsetsInternal.size.height,g=c-(v+m),y=0,b=0,w=cc.RectMake(y,b,h,v);y+=h;var E=cc.RectMake(y,b,p,v);y+=p;var S=cc.RectMake(y,b,d,v);y=0,b=0,b+=v;var x=cc.RectMake(y,b,h,m);y+=h;var T=cc.RectMake(y,b,p,m);y+=p;var N=cc.RectMake(y,b,d,m);y=0,b=0,b+=v,b+=m;var C=cc.RectMake(y,b,h,g);y+=h;var k=cc.RectMake(y,b,p,g);y+=p;var L=cc.RectMake(y,b,d,g);if(!n){var A=cc.AffineTransformMakeIdentity();A=cc.AffineTransformTranslate(A,t.origin.x,t.origin.y),T=cc.RectApplyAffineTransform(T,A),L=cc.RectApplyAffineTransform(L,A),C=cc.RectApplyAffineTransform(C,A),S=cc.RectApplyAffineTransform(S,A),w=cc.RectApplyAffineTransform(w,A),N=cc.RectApplyAffineTransform(N,A),x=cc.RectApplyAffineTransform(x,A),k=cc.RectApplyAffineTransform(k,A),E=cc.RectApplyAffineTransform(E,A),this._centre=new cc.Sprite,this._centre.initWithTexture(o,T),this._scale9Image.addChild(this._centre,0,cc.POSITIONS_CENTRE),this._top=new cc.Sprite,this._top.initWithTexture(o,E),this._scale9Image.addChild(this._top,1,cc.POSITIONS_TOP),this._bottom=new cc.Sprite,this._bottom.initWithTexture(o,k),this._scale9Image.addChild(this._bottom,1,cc.POSITIONS_BOTTOM),this._left=new cc.Sprite,this._left.initWithTexture(o,x),this._scale9Image.addChild(this._left,1,cc.POSITIONS_LEFT),this._right=new cc.Sprite,this._right.initWithTexture(o,N),this._scale9Image.addChild(this._right,1,cc.POSITIONS_RIGHT),this._topLeft=new cc.Sprite,this._topLeft.initWithTexture(o,w),this._scale9Image.addChild(this._topLeft,2,cc.POSITIONS_TOPLEFT),this._topRight=new cc.Sprite,this._topRight.initWithTexture(o,S),this._scale9Image.addChild(this._topRight,2,cc.POSITIONS_TOPRIGHT),this._bottomLeft=new cc.Sprite,this._bottomLeft.initWithTexture(o,C),this._scale9Image.addChild(this._bottomLeft,2,cc.POSITIONS_BOTTOMLEFT),this._bottomRight=new cc.Sprite,this._bottomRight.initWithTexture(o,L),this._scale9Image.addChild(this._bottomRight,2,cc.POSITIONS_BOTTOMRIGHT)}else{var A=cc.AffineTransformMakeIdentity(),O=T,M=L,_=C,D=S,P=w,H=N,B=x,j=k,F=E;A=cc.AffineTransformTranslate(A,t.size.height+t.origin.x,t.origin.y),A=cc.AffineTransformRotate(A,1.57079633),T=cc.RectApplyAffineTransform(T,A),L=cc.RectApplyAffineTransform(L,A),C=cc.RectApplyAffineTransform(C,A),S=cc.RectApplyAffineTransform(S,A),w=cc.RectApplyAffineTransform(w,A),N=cc.RectApplyAffineTransform(N,A),x=cc.RectApplyAffineTransform(x,A),k=cc.RectApplyAffineTransform(k,A),E=cc.RectApplyAffineTransform(E,A),O.origin={x:T.origin.x,y:T.origin.y},M.origin={x:L.origin.x,y:L.origin.y},_.origin={x:C.origin.x,y:C.origin.y},D.origin={x:S.origin.x,y:S.origin.y},P.origin={x:w.origin.x,y:w.origin.y},H.origin={x:N.origin.x,y:N.origin.y},B.origin={x:x.origin.x,y:x.origin.y},j.origin={x:k.origin.x,y:k.origin.y},F.origin={x:E.origin.x,y:E.origin.y},this._centre=new cc.Sprite,this._centre.initWithTexture(o,O,!0),this._scale9Image.addChild(this._centre,0,cc.POSITIONS_CENTRE),this._top=new cc.Sprite,this._top.initWithTexture(o,F,!0),this._scale9Image.addChild(this._top,1,cc.POSITIONS_TOP),this._bottom=new cc.Sprite,this._bottom.initWithTexture(o,j,!0),this._scale9Image.addChild(this._bottom,1,cc.POSITIONS_BOTTOM),this._left=new cc.Sprite,this._left.initWithTexture(o,B,!0),this._scale9Image.addChild(this._left,1,cc.POSITIONS_LEFT),this._right=new cc.Sprite,this._right.initWithTexture(o,H,!0),this._scale9Image.addChild(this._right,1,cc.POSITIONS_RIGHT),this._topLeft=new cc.Sprite,this._topLeft.initWithTexture(o,P,!0),this._scale9Image.addChild(this._topLeft,2,cc.POSITIONS_TOPLEFT),this._topRight=new cc.Sprite,this._topRight.initWithTexture(o,D,!0),this._scale9Image.addChild(this._topRight,2,cc.POSITIONS_TOPRIGHT),this._bottomLeft=new cc.Sprite,this._bottomLeft.initWithTexture(o,_,!0),this._scale9Image.addChild(this._bottomLeft,2,cc.POSITIONS_BOTTOMLEFT),this._bottomRight=new cc.Sprite,this._bottomRight.initWithTexture(o,M,!0),this._scale9Image.addChild(this._bottomRight,2,cc.POSITIONS_BOTTOMRIGHT)}return this.setContentSize(t.size),this.addChild(this._scale9Image),this._spritesGenerated&&(this.setOpacity(i),this.setColor(s)),this._spritesGenerated=!0,!0},setSpriteFrame:function(e){var t=cc.SpriteBatchNode.createWithTexture(e.getTexture(),9);this.updateWithBatchNode(t,e.getRect(),cc.Browser.supportWebGL?e.isRotated():!1,cc.RectZero()),this._insetLeft=0,this._insetTop=0,this._insetRight=0,this._insetBottom=0},setColor:function(e){this._color=e;var t=this._scale9Image.getChildren();if(t)for(var n=0;n<t.length;n++)t[n].setColor(this._color)},setOpacity:function(e){this._opacity=e;var t=this._scale9Image.getChildren();if(t)for(var n=0;n<t.length;n++)t[n].setOpacity(this._color)}}),cc.Scale9Sprite.create=function(e,t,n){var r;if(arguments.length===2){if(typeof e=="string"){r=new cc.Scale9Sprite;if(r&&r.initWithFile(e,t))return r}else if(e instanceof cc.Rect){r=new cc.Scale9Sprite;if(r&&r.initWithFile(e,n))return r}}else if(arguments.length===3){r=new cc.Scale9Sprite;if(r&&r.initWithFile(e,t,n))return r}else if(arguments.length===1){r=new cc.Scale9Sprite;if(r&&r.initWithFile(e))return r}else if(arguments.length===0){r=new cc.Scale9Sprite;if(r&&r.init())return r}return null},cc.Scale9Sprite.createWithSpriteFrame=function(e,t){var n=new cc.Scale9Sprite;return n&&n.initWithSpriteFrame(e,t)?n:null},cc.Scale9Sprite.createWithSpriteFrameName=function(e,t){cc.Assert(e!=null,"spriteFrameName must be non-NULL");var n=new cc.Scale9Sprite;return n&&n.initWithSpriteFrameName(e,t)?n:null};cc.Spacer=cc.Layer.extend({}),cc.Spacer.verticalSpacer=function(e){var t=new cc.Spacer;return t.init(),t.setContentSize(cc.SizeMake(0,e)),t},cc.Spacer.horizontalSpacer=function(e){var t=new cc.Spacer;return t.init(),t.setContentSize(cc.SizeMake(e,0)),t},cc.MenuPassive=cc.Layer.extend({RGBAProtocol:!0,_color:null,_opacity:0,ctor:function(){},getColor:function(){return this._color},setColor:function(e){this._color=e;if(this._children&&this._children.length>0)for(var t=0;t<this._children.length;t++)this._children[t]&&this._children[t].RGBAProtocol&&this._children[t].setColor(e)},getOpacity:function(){return this._opacity},setOpacity:function(e){this._opacity=e;if(this._children&&this._children.length>0)for(var t=0;t<this._children.length;t++)this._children[t]&&this._children[t].RGBAProtocol&&this._children[t].setOpacity(e)},initWithItems:function(e,t){if(this.init()){var n=cc.Director.getInstance().getWinSize();this.ignoreAnchorPointForPosition(!0),this.setAnchorPoint(cc.p(.5,.5)),this.setContentSize(n),this.setPosition(cc.p(n.width/2,n.height/2));var r=0;if(e){this.addChild(e,r);for(var i=0;i<t.length;i++)t[i]&&(r++,this.addChild(t[i],r))}return!0}return!1},alignItemsVertically:function(){this.alignItemsVerticallyWithPadding(cc.DEFAULT_PADDING)},alignItemsVerticallyWithPadding:function(e){var t=-e,n;if(this._children&&this._children.length>0)for(n=0;n<this._children.length;n++)this._children[n]&&(t+=this._children[n].getContentSize().height*this._children[n].getScaleY()+e);var r=0,i=t/2;if(this._children&&this._children.length>0)for(n=0;n<this._children.length;n++)this._children[n]&&(r=Math.max(r,this._children[n].getContentSize().width),this._children[n].setPosition(cc.p(0,i-this._children[n].getContentSize().height*this._children[n].getScaleY()/2)),i-=this._children[n].getContentSize().height*this._children[n].getScaleY()+e);this.setContentSize(cc.SizeMake(r,t))},alignItemsHorizontally:function(){this.alignItemsHorizontallyWithPadding(cc.DEFAULT_PADDING)},alignItemsHorizontallyWithPadding:function(e){var t=-e,n;if(this._children&&this._children.length>0)for(n=0;n<this._children.length;n++)this._children[n]&&(t+=this._children[n].getContentSize().width*this._children[n].getScaleX()+e);var r=0,i=-t/2;if(this._children&&this._children.length>0)for(n=0;n<this._children.length;n++)this._children[n]&&(r=Math.max(r,this._children[n].getContentSize().height),this._children[n].setPosition(cc.p(i+this._children[n].getContentSize().width*this._children[n].getScaleX()/2,0)),i+=this._children[n].getContentSize().width*this._children[n].getScaleX()+e);this.setContentSize(cc.SizeMake(t,r))},alignItemsInColumns:function(e){var t=[],n;for(n=1;n<arguments.length;n++)t.push(arguments[n]);var r=-5,i=0,s=0,o=0,u,a;if(this._children&&this._children.length>0)for(n=0;n<this._children.length;n++)this._children[n]&&(cc.Assert(i<t.size(),""),u=t[i],cc.Assert(u,""),a=this._children[n].getContentSize().height,s=0|(s>=a||a==null?s:a),++o,o>=u&&(r+=s+5,o=0,s=0,++i));cc.Assert(!o,"");var f=cc.Director.getInstance().getWinSize();i=0,s=0,u=0;var l=0,c=0,h=r/2;if(this._children&&this._children.length>0)for(n=0;n<this._children.length;n++)this._children[n]&&(u==0&&(u=t[i],l=f.width/(1+u),c=l),a=this._children[n].getContentSize().height,s=0|(s>=a||a==null?s:a),this._children[n].setPosition(cc.p(c-f.width/2,h-this._children[n].getContentSize().height/2)),c+=l,++o,o>=u&&(h-=s+5,o=0,u=0,s=0,++i))},alignItemsInRows:function(e){var t=[],n;for(n=1;n<arguments.length;n++)t.push(arguments[n]);var r=[],i=[],s=-10,o=-5,u=0,a=0,f=0,l,c;if(this._children&&this._children.length>0)for(n=0;n<this._children.length;n++)this._children[n]&&(cc.Assert(u<t.size(),""),l=t[u],cc.Assert(l,""),c=this._children[n].getContentSize().width,a=0|(a>=c||c==null?a:c),o+=0|this._children[n].getContentSize().height+5,++f,f>=l&&(r.push(a),i.push(o),s+=a+10,f=0,a=0,o=-5,++u));cc.Assert(!f,"");var h=cc.Director.getInstance().getWinSize();u=0,a=0,l=null;var p=-s/2,d=0;if(this._children&&this._children.length>0)for(n=0;n<this._children.length;n++)this._children[n]&&(l==null&&(l=t[u],d=i[u]),c=this._children[n].getContentSize().width,a=0|(a>=c||c==null?a:c),this._children[n].setPosition(cc.p(p+r[u]/2,d-h.height/2)),d-=this._children[n].getContentSize().height+10,++f,f>=l&&(p+=a+5,f=0,l=0,a=0,++u))},setOpacityModifyRGB:function(e){},isOpacityModifyRGB:function(){return!1}}),cc.MenuPassive.create=function(e){arguments.length==0&&(e=null);var t=[];for(var n=1;n<arguments.length;n++)t.push(arguments[n]);var r=new cc.MenuPassive;return r&&r.initWithItems(e,t)?r:null},cc.MenuPassive.createWithItem=function(e){return cc.MenuPassive.create(e,null)};cc.ControlSaturationBrightnessPicker=cc.Control.extend({_saturation:0,_brightness:0,_background:null,_overlay:null,_shadow:null,_slider:null,_startPos:null,_boxPos:0,_boxSize:0,getSaturation:function(){return this._saturation},getBrightness:function(){return this._brightness},getBackground:function(){return this._background},getOverlay:function(){return this._brightness},getShadow:function(){return this._shadow},getSlider:function(){return this._slider},getStartPos:function(){return this._startPos},initWithTargetAndPos:function(e,t){return this.init()?(this.setTouchEnabled(!0),this._background=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPickerBackground.png",e,t,cc.p(0,0)),this._overlay=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPickerOverlay.png",e,t,cc.p(0,0)),this._shadow=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPickerShadow.png",e,t,cc.p(0,0)),this._slider=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPicker.png",e,t,cc.p(.5,.5)),this._startPos=t,this._boxPos=35,this._boxSize=150,!0):!1},updateWithHSV:function(e){var t=new cc.HSV;t.s=1,t.h=e.h,t.v=1;var n=cc.ControlUtils.RGBfromHSV(t);this._background.setColor(cc.c3(0|n.r*255,0|n.g*255,0|n.b*255))},updateDraggerWithHSV:function(e){var t=cc.PointMake(this._startPos.x+this._boxPos+this._boxSize*(1-e.s),this._startPos.y+this._boxPos+this._boxSize*e.v);this._updateSliderPosition(t)},_updateSliderPosition:function(e){var t=this._startPos.x+this._background.getBoundingBox().size.width*.5,n=this._startPos.y+this._background.getBoundingBox().size.height*.5,r=e.x-t,i=e.y-n,s=Math.sqrt(r*r+i*i),o=Math.atan2(i,r),u=this._background.getBoundingBox().size.width*.5;s>u&&(e.x=t+u*Math.cos(o),e.y=n+u*Math.sin(o)),this._slider.setPosition(e),e.x<this._startPos.x+this._boxPos?e.x=this._startPos.x+this._boxPos:e.x>this._startPos.x+this._boxPos+this._boxSize-1&&(e.x=this._startPos.x+this._boxPos+this._boxSize-1),e.y<this._startPos.y+this._boxPos?e.y=this._startPos.y+this._boxPos:e.y>this._startPos.y+this._boxPos+this._boxSize&&(e.y=this._startPos.y+this._boxPos+this._boxSize),this._saturation=1-Math.abs((this._startPos.x+this._boxPos-e.x)/this._boxSize),this._brightness=Math.abs((this._startPos.y+this._boxPos-e.y)/this._boxSize)},_checkSliderPosition:function(e){var t=this._startPos.x+this._background.getBoundingBox().size.width*.5,n=this._startPos.y+this._background.getBoundingBox().size.height*.5,r=e.x-t,i=e.y-n,s=Math.sqrt(r*r+i*i);return s<=this._background.getBoundingBox().size.width*.5?(this._updateSliderPosition(e),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED),!0):!1},onTouchBegan:function(e,t){var n=this.getTouchLocation(e);return this._checkSliderPosition(n)},onTouchMoved:function(e,t){var n=this.getTouchLocation(e);this._updateSliderPosition(n),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)}}),cc.ControlSaturationBrightnessPicker.create=function(e,t){var n=new cc.ControlSaturationBrightnessPicker;return n.initWithTargetAndPos(e,t),n};cc.ControlHuePicker=cc.Control.extend({_hue:0,_huePercentage:0,_background:null,_slider:null,_startPos:null,getHue:function(){return this._hue},setHue:function(e){m_hue=e,this.setHuePercentage(m_hue/360)},getHuePercentage:function(){return this._huePercentage},setHuePercentage:function(e){this._huePercentage=e,this._hue=this._huePercentage*360;var t=this._background.getBoundingBox(),n=this._startPos.x+t.size.width*.5,r=this._startPos.y+t.size.height*.5,i=t.size.width*.5-15,s=this._huePercentage*360-180,o=cc.DEGREES_TO_RADIANS(s),u=n+i*Math.cos(o),a=r+i*Math.sin(o);this._slider.setPosition(cc.p(u,a))},getBackground:function(){return this._background},getSlider:function(){return this._slider},getStartPos:function(){return this._startPos},initWithTargetAndPos:function(e,t){return this.init()?(this.setTouchEnabled(!0),this._background=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("huePickerBackground.png",e,t,cc.p(0,0)),this._slider=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPicker.png",e,t,cc.p(.5,.5)),this._slider.setPosition(cc.p(t.x,t.y+this._background.getBoundingBox().size.height*.5)),this._startPos=t,this._hue=0,this._huePercentage=0,!0):!1},_updateSliderPosition:function(e){var t=this._background.getBoundingBox(),n=this._startPos.x+t.size.width*.5,r=this._startPos.y+t.size.height*.5,i=e.x-n,s=e.y-r,o=Math.atan2(s,i),u=cc.RADIANS_TO_DEGREES(o)+180;this.setHue(u),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},_checkSliderPosition:function(e){return cc.Rect.CCRectContainsPoint(this._background.getBoundingBox(),e)?(this._updateSliderPosition(e),!0):!1},onTouchBegan:function(e,t){var n=this.getTouchLocation(e);return this._checkSliderPosition(n)},onTouchMoved:function(e,t){var n=this.getTouchLocation(e);this._updateSliderPosition(n),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)}}),cc.ControlHuePicker.create=function(e,t){var n=new cc.ControlHuePicker;return n.initWithTargetAndPos(e,t),n};cc.ControlColourPicker=cc.Control.extend({_colorValue:null,_hsv:null,_colourPicker:null,_huePicker:null,_background:null,hueSliderValueChanged:function(e,t){this._hsv.h=e.getHue();var n=cc.ControlUtils.RGBfromHSV(this._hsv);this._colorValue=cc.c3(0|n.r*255,0|n.g*255,0|n.b*255),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED),this._updateControlPicker()},colourSliderValueChanged:function(e,t){this._hsv.s=e.getSaturation(),this._hsv.v=e.getBrightness();var n=cc.ControlUtils.RGBfromHSV(this._hsv);this._colorValue=cc.c3(0|n.r*255,0|n.g*255,0|n.b*255),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},getColorValue:function(){return this._colorValue},setColorValue:function(e){this._colorValue=e;var t=new cc.RGBA;t.r=e.r/255,t.g=e.g/255,t.b=e.b/255,t.a=1,this._hsv=cc.ControlUtils.HSVfromRGB(t),this._updateHueAndControlPicker()},getBackground:function(){return this._background},init:function(){if(this._super()){this.setTouchEnabled(!0),cc.SpriteFrameCache.getInstance().addSpriteFrames("extensions/CCControlColourPickerSpriteSheet.plist");var e=cc.SpriteBatchNode.create("extensions/CCControlColourPickerSpriteSheet.png");this.addChild(e);var t=[GL_LINEAR_MIPMAP_LINEAR,GL_LINEAR,GL_REPEAT,GL_REPEAT];e.getTexture().setAliasTexParameters(),e.getTexture().setTexParameters(t),e.getTexture().generateMipmap(),this._hsv.h=0,this._hsv.s=0,this._hsv.v=0,this._background=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("menuColourPanelBackground.png",e,cc.PointZero,cc.p(.5,.5));var n=cc.pSub(this._background.getPosition(),cc.p(this._background.getContentSize().width/2,this._background.getContentSize().height/2)),r=8,i=28;return this._huePicker=cc.ControlHuePicker.create(e,cc.p(n.x+r,n.y+r)),this._colourPicker=cc.ControlSaturationBrightnessPicker.create(e,cc.p(n.x+i,n.y+i)),this._huePicker.addTargetWithActionForControlEvents(this,this.hueSliderValueChanged,cc.CONTROL_EVENT_VALUECHANGED),this._colourPicker.addTargetWithActionForControlEvents(this,this.colourSliderValueChanged,cc.CONTROL_EVENT_VALUECHANGED),this._updateHueAndControlPicker(),this.addChild(this._huePicker),this.addChild(this._colourPicker),this.setContentSize(this._background.getContentSize()),!0}return!1},_updateControlPicker:function(){this._huePicker.setHue(this._hsv.h),this._colourPicker.updateWithHSV(this._hsv)},_updateHueAndControlPicker:function(){this._huePicker.setHue(this._hsv.h),this._colourPicker.updateWithHSV(this._hsv),this._colourPicker.updateDraggerWithHSV(this._hsv)},onTouchBegan:function(){return!1}}),cc.ControlColourPicker.create=function(){var e=new cc.ControlColourPicker;return e.init(),e};cc.SLIDER_MARGIN_H=24,cc.SLIDER_MARGIN_V=8,cc.ControlSlider=cc.Control.extend({_value:0,_minimumValue:0,_maximumValue:0,_minimumAllowedValue:0,_maximumAllowedValue:0,_snappingInterval:0,_thumbItem:null,_progressSprite:null,_backgroundSprite:null,getValue:function(){return this._value},setValue:function(e){e=Math.max(e,this._minimumValue),e=Math.min(e,this._maximumValue),this._snappingInterval>=0&&(e=Math.floor(.5+e/this._snappingInterval)*this._snappingInterval),this._value=e;var t=(this._value-this._minimumValue)/(this._maximumValue-this._minimumValue),n=this._thumbItem.getPosition();n.x=t*this._backgroundSprite.getContentSize().width+cc.SLIDER_MARGIN_H,this._thumbItem.setPosition(n);var r=this._progressSprite.getTextureRect();r=cc.RectMake(r.origin.x,r.origin.y,t*this._backgroundSprite.getContentSize().width,r.size.height),this._progressSprite.setTextureRect(r,this._progressSprite.isTextureRectRotated(),r.size),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},getMinimumValue:function(){return this._minimumValue},setMinimumValue:function(e){this._minimumValue=e,this._minimumAllowedValue=e,this._minimumValue>=this._maximumValue&&(this._maximumValue=this._minimumValue+1),this.setValue(this._value)},getMaximumValue:function(){return this._maximumValue},setMaximumValue:function(e){this._maximumValue=e,this._maximumAllowedValue=e,this._maximumValue<=this._minimumValue&&(this._minimumValue=this._maximumValue-1),this.setValue(this._value)},getMinimumAllowedValue:function(){return this._minimumAllowedValue},setMinimumAllowedValue:function(e){this._minimumAllowedValue=e},getMaximumAllowedValue:function(){return this._maximumAllowedValue},setMaximumAllowedValue:function(e){this._maximumAllowedValue=e},getSnappingInterval:function(){return this._snappingInterval},setSnappingInterval:function(e){this._snappingInterval=e},getThumbItem:function(){return this._thumbItem},getProgressSprite:function(){return this._progressSprite},getBackgroundSprite:function(){return this._backgroundSprite},initWithSprites:function(e,t,n){if(this.init()){this.ignoreAnchorPointForPosition(!1),this.setTouchEnabled(!0),this._backgroundSprite=e,this._progressSprite=t,this._thumbItem=n;var r=cc.ControlUtils.CCRectUnion(e.getBoundingBox(),n.getBoundingBox()),i=cc.SizeMake(r.size.width+2*cc.SLIDER_MARGIN_H,r.size.height+2*cc.SLIDER_MARGIN_V);return this.setContentSize(i),this._backgroundSprite.setAnchorPoint(cc.p(.5,.5)),this._backgroundSprite.setPosition(cc.p(i.width/2,i.height/2)),this.addChild(this._backgroundSprite),this._progressSprite.setAnchorPoint(cc.p(0,.5)),this._progressSprite.setPosition(cc.p(0+cc.SLIDER_MARGIN_H,i.height/2)),this.addChild(this._progressSprite),this._thumbItem.setPosition(cc.p(0+cc.SLIDER_MARGIN_H,i.height/2)),this.addChild(this._thumbItem),this._minimumValue=0,this._maximumValue=1,this._snappingInterval=-1,this.setValue(this._minimumValue),!0}return!1},sliderBegan:function(e){this._thumbItem.selected(),this.setValue(this.valueForLocation(e))},sliderMoved:function(e){this.setValue(this.valueForLocation(e))},sliderEnded:function(e){this._thumbItem.isSelected()&&(this._thumbItem.unselected(),this.setValue(this.valueForLocation(this._thumbItem.getPosition())))},getTouchLocationInControl:function(e){var t=e.getLocation();return t=this.convertToNodeSpace(t),t.x<0?t.x=0:t.x>this._backgroundSprite.getContentSize().width+cc.SLIDER_MARGIN_H&&(t.x=this._backgroundSprite.getContentSize().width+cc.SLIDER_MARGIN_H),t},onTouchBegan:function(e,t){if(!this.isTouchInside(e))return!1;var n=this.getTouchLocationInControl(e);return this.sliderBegan(n),!0},onTouchMoved:function(e,t){var n=this.getTouchLocationInControl(e);this.sliderMoved(n)},onTouchEnded:function(e,t){this.sliderEnded(cc.PointZero())},valueForLocation:function(e){var t=(e.x-cc.SLIDER_MARGIN_H)/this._backgroundSprite.getContentSize().width;return Math.max(Math.min(this._minimumValue+t*(this._maximumValue-this._minimumValue),this._maximumAllowedValue),this._minimumAllowedValue)}}),cc.ControlSlider.create=function(e,t,n){if(typeof e=="string"){e=cc.Sprite.create(e),t=cc.Sprite.create(t);var r=cc.Sprite.create(n),i=cc.Sprite.create(n);i.setColor(cc.gray()),n=cc.MenuItemSprite.create(r,i)}var s=new cc.ControlSlider;return s.initWithSprites(e,t,n),s};cc.ControlSwitch=cc.Control.extend({_switchSprite:null,_initialTouchXPosition:0,_moved:!1,_on:!1,ctor:function(){},initWithMaskSprite:function(e,t,n,r,i,s){return this.init()?(cc.Assert(e,"Mask must not be nil."),cc.Assert(t,"onSprite must not be nil."),cc.Assert(n,"offSprite must not be nil."),cc.Assert(r,"thumbSprite must not be nil."),this.setTouchEnabled(!0),this._on=!0,this._switchSprite=new cc.ControlSwitchSprite,this._switchSprite.initWithMaskSprite(e,t,n,r,i,s),this._switchSprite.setPosition(cc.p(this._switchSprite.getContentSize().width/2,this._switchSprite.getContentSize().height/2)),this.addChild(this._switchSprite),this.ignoreAnchorPointForPosition(!1),this.setAnchorPoint(cc.p(.5,.5)),this.setContentSize(this._switchSprite.getContentSize()),!0):!1},setOn:function(e,t){t=t||!1,this._on=e,this._switchSprite.runAction(cc.ActionTween.create(.2,"sliderXPosition",this._switchSprite.getSliderXPosition(),this._on?this._switchSprite.getOnPosition():this._switchSprite.getOffPosition())),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},isOn:function(){return this._on},hasMoved:function(){return this._moved},setEnabled:function(e){this._enabled=e,this._switchSprite.setOpacity(e?255:128)},locationFromTouch:function(e){var t=e.getLocation();return t=this.convertToNodeSpace(t),t},onTouchBegan:function(e,t){if(!this.isTouchInside(e)||!this.isEnabled())return!1;this._moved=!1;var n=this.locationFromTouch(e);return this._initialTouchXPosition=n.x-this._switchSprite.getSliderXPosition(),this._switchSprite.getThumbSprite().setColor(cc.gray()),this._switchSprite.needsLayout(),!0},onTouchMoved:function(e,t){var n=this.locationFromTouch(e);n=cc.p(n.x-this._initialTouchXPosition,0),this._moved=!0,this._switchSprite.setSliderXPosition(n.x)},onTouchEnded:function(e,t){var n=this.locationFromTouch(e);this._switchSprite.getThumbSprite().setColor(cc.white()),this.hasMoved()?this.setOn(!(n.x<this._switchSprite.getContentSize().width/2),!0):this.setOn(!this._on,!0)},onTouchCancelled:function(e,t){var n=this.locationFromTouch(e);this._switchSprite.getThumbSprite().setColor(cc.white()),this.hasMoved()?this.setOn(!(n.x<this._switchSprite.getContentSize().width/2),!0):this.setOn(!this._on,!0)}}),cc.ControlSwitch.create=function(e,t,n,r,i,s){var o=new cc.ControlSwitch;return o&&o.initWithMaskSprite(e,t,n,r,i,s)?o:null},cc.ControlSwitchSprite=cc.Sprite.extend({_sliderXPosition:0,_onPosition:0,_offPosition:0,_maskTexture:null,_textureLocation:0,_maskLocation:0,_onSprite:null,_offSprite:null,_thumbSprite:null,_onLabel:null,_offLabel:null,ctor:function(){},initWithMaskSprite:function(e,t,n,r,i,s){return this.initWithTexture(e.getTexture())?(this._onPosition=0,this._offPosition=-t.getContentSize().width+r.getContentSize().width/2,this._sliderXPosition=this._onPosition,this.setOnSprite(t),this.setOffSprite(n),this.setThumbSprite(r),this.setOnLabel(i),this.setOffLabel(s),this.addChild(this._thumbSprite),this.setMaskTexture(e.getTexture()),this.setContentSize(this._maskTexture.getContentSize()),this.needsLayout(),!0):!1},draw:function(){cc.NODE_DRAW_SETUP()},needsLayout:function(){this._onSprite.setPosition(cc.p(this._onSprite.getContentSize().width/2+this._sliderXPosition,this._onSprite.getContentSize().height/2)),this._offSprite.setPosition(cc.p(this._onSprite.getContentSize().width+this._offSprite.getContentSize().width/2+this._sliderXPosition,this._offSprite.getContentSize().height/2)),this._thumbSprite.setPosition(cc.p(this._onSprite.getContentSize().width+this._sliderXPosition,this._maskTexture.getContentSize().height/2)),this._onLabel&&this._onLabel.setPosition(cc.p(this._onSprite.getPosition().x-this._thumbSprite.getContentSize().width/6,this._onSprite.getContentSize().height/2)),this._offLabel&&this._offLabel.setPosition(cc.p(this._offSprite.getPosition().x+this._thumbSprite.getContentSize().width/6,this._offSprite.getContentSize().height/2));var e=cc.RenderTexture.create(this._maskTexture.getContentSize().width,this._maskTexture.getContentSize().height);e.begin(),this._onSprite.visit(),this._offSprite.visit(),this._onLabel&&this._onLabel.visit(),this._offLabel&&this._offLabel.visit(),e.end(),this.setTexture(e.getSprite().getTexture()),this.setFlipY(!0)},setSliderXPosition:function(e){e<=this._offPosition?e=this._offPosition:e>=this._onPosition&&(e=this._onPosition),this._sliderXPosition=e,this.needsLayout()},getSliderXPosition:function(){return this._sliderXPosition},onSideWidth:function(){return this._onSprite.getContentSize().width},offSideWidth:function(){return this._offSprite.getContentSize().height},updateTweenAction:function(e,t){cc.log("key = "+t+", value = "+e),this.setSliderXPosition(e)},setOnPosition:function(e){this._onPosition=e},getOnPosition:function(){return this._onPosition},setOffPosition:function(e){this._offPosition=e},getOffPosition:function(){return this._offPosition},setMaskTexture:function(e){this._maskTexture=e},getMaskTexture:function(){return this._maskTexture},setTextureLocation:function(e){this._textureLocation=e},getTextureLocation:function(){return this._textureLocation},setMaskLocation:function(e){this._maskLocation=e},getMaskLocation:function(){return this._maskLocation},setOnSprite:function(e){this._onSprite=e},getOnSprite:function(){return this._onSprite},setOffSprite:function(e){this._offSprite=e},getOffSprite:function(){return this._offSprite},setThumbSprite:function(e){this._thumbSprite=e},getThumbSprite:function(){return this._thumbSprite},setOnLabel:function(e){this._onLabel=e},getOnLabel:function(){return this._onLabel},setOffLabel:function(e){this._offLabel=e},getOffLabel:function(){return this._offLabel}});cc.SCROLLVIEW_DIRECTION_NONE=-1,cc.SCROLLVIEW_DIRECTION_HORIZONTAL=0,cc.SCROLLVIEW_DIRECTION_VERTICAL=1,cc.SCROLLVIEW_DIRECTION_BOTH=2;var SCROLL_DEACCEL_RATE=.95,SCROLL_DEACCEL_DIST=1,BOUNCE_DURATION=.15,INSET_RATIO=.2;cc.ScrollViewDelegate=cc.Class.extend({scrollViewDidScroll:function(e){},scrollViewDidZoom:function(e){}}),cc.ScrollView=cc.Layer.extend({_zoomScale:0,_minZoomScale:0,_maxZoomScale:0,_delegate:null,_direction:cc.SCROLLVIEW_DIRECTION_BOTH,_dragging:!1,_contentOffset:null,_container:null,_touchMoved:!1,_maxInset:null,_minInset:null,_bounceable:!1,_clippingToBounds:!1,_scrollDistance:null,_touchPoint:null,_touchLength:0,_touches:null,_viewSize:null,_minScale:0,_maxScale:0,ctor:function(){this._super(),this._maxInset=new cc.Point(0,0),this._minInset=new cc.Point(0,0),this._scrollDistance=new cc.Point(0,0),this._touchPoint=new cc.Point(0,0),this._touches=[],this._viewSize=new cc.Size(0,0),this._isTouched=!1},init:function(e){return e!=null&&e==1?this._super():this.initWithViewSize(cc.SizeMake(200,200),null)},registerWithTouchDispatcher:function(){cc.Director.getInstance().getTouchDispatcher().addTargetedDelegate(this,0,!1)},initWithViewSize:function(e,t){return cc.Layer.prototype.init.call(this)?(this._container=t,this._container||(this._container=cc.Layer.create(),this._container.ignoreAnchorPointForPosition(!1),this._container.setAnchorPoint(cc.p(0,0))),this.setViewSize(e),this.setTouchEnabled(!0),this._touches=[],this._delegate=null,this._bounceable=!0,this._clippingToBounds=!0,this._direction=cc.SCROLLVIEW_DIRECTION_BOTH,this._container.setPosition(cc.p(0,0)),this._touchLength=0,this.addChild(this._container),this._minScale=this._maxScale=1,!0):!1},setContentOffset:function(e,t){if(t)this.setContentOffsetInDuration(e,BOUNCE_DURATION);else{if(!this._bounceable){var n=this.minContainerOffset(),r=this.maxContainerOffset();e.x=Math.max(n.x,Math.min(r.x,e.x)),e.y=Math.max(n.y,Math.min(r.y,e.y))}this._container.setPosition(e),this._delegate!=null&&this._delegate.scrollViewDidScroll&&this._delegate.scrollViewDidScroll(this)}},getContentOffset:function(){return this._container.getPosition()},setContentOffsetInDuration:function(e,t){var n=cc.MoveTo.create(t,e),r=cc.CallFunc.create(this._stoppedAnimatedScroll,this);this._container.runAction(cc.Sequence.create(n,r)),this.schedule(this._performedAnimatedScroll)},setZoomScale:function(e,t){if(arguments.length===1){if(this._container.getScale()!=e){var n,r,i;this._touchLength==0?(i=cc.p(this._viewSize.width*.5,this._viewSize.height*.5),i=this.convertToWorldSpace(i)):i=this._touchPoint,n=this._container.convertToNodeSpace(i),this._container.setScale(Math.max(this._minScale,Math.min(this._maxScale,e))),r=this._container.convertToWorldSpace(n);var s=cc.pSub(i,r);this._delegate!=null&&this._delegate.scrollViewDidZoom(this),this.setContentOffset(cc.pAdd(this._container.getPosition(),s))}}else arguments.length===2&&(t?this.setZoomScaleInDuration(e,BOUNCE_DURATION):this.setZoomScale(e))},getZoomScale:function(){return this._container.getScale()},setZoomScaleInDuration:function(e,t){if(t>0){if(this._container.getScale()!=e){var n=cc.ActionTween.create(t,"zoomScale",this._container.getScale(),e);this.runAction(n)}}else this.setZoomScale(e)},minContainerOffset:function(){return cc.p(this._viewSize.width-this._container.getContentSize().width*this._container.getScaleX(),this._viewSize.height-this._container.getContentSize().height*this._container.getScaleY())},maxContainerOffset:function(){return cc.p(0,0)},isNodeVisible:function(e){var t=this.getContentOffset(),n=this.getViewSize(),r=this.getZoomScale(),i=cc.RectMake(-t.x/r,-t.y/r,n.width/r,n.height/r);return cc.CCRectIntersectsRect(i,e.getBoundingBox())},pause:function(e){this._container.pauseSchedulerAndActions();var t=this._container.getChildren();for(var n=0;n<t.length;n++)t[n].pauseSchedulerAndActions()},resume:function(e){var t=this._container.getChildren();for(var n=0;n<t.length;n++)t[n].resumeSchedulerAndActions();this._container.resumeSchedulerAndActions()},isDragging:function(){return this._dragging},isTouchMoved:function(){return this._touchMoved},isBounceable:function(){return this._bounceable},setBounceable:function(e){this._bounceable=e},getViewSize:function(){return this._viewSize},setViewSize:function(e){this._viewSize=e,this.setContentSize(e,!0)},getContainer:function(){return this._container},setContainer:function(e){this.removeAllChildren(!0);if(!e)return;this._container=e,this._container.ignoreAnchorPointForPosition(!1),this._container.setAnchorPoint(cc.p(0,0)),this.addChild(this._container),this.setViewSize(this._viewSize)},getDirection:function(){return this._direction},setDirection:function(e){this._direction=e},getDelegate:function(){return this._delegate},setDelegate:function(e){this._delegate=e},onTouchBegan:function(e,t){if(!this.isVisible())return!1;var n=this.getParent().convertToWorldSpace(this.getPosition()),r=cc.RectMake(n.x,n.y,this._viewSize.width,this._viewSize.height),i=this._container.convertToWorldSpace(this._container.convertTouchToNodeSpace(e));return this._touches.length>2||this._touchMoved||!cc.Rect.CCRectContainsPoint(r,i)?!1:(this._touches.push(e),this._touches.length==1?(this._touchPoint=this.convertTouchToNodeSpace(e),this._touchMoved=!1,this._dragging=!0,this._scrollDistance=cc.p(0,0),this._touchLength=0):this._touches.length==2&&(this._touchPoint=cc.pMidpoint(this.convertTouchToNodeSpace(this._touches[0]),this.convertTouchToNodeSpace(this._touches[1])),this._touchLength=cc.pDistance(this._container.convertTouchToNodeSpace(this._touches[0]),this._container.convertTouchToNodeSpace(this._touches[1])),this._dragging=!1),!0)},onTouchMoved:function(e,t){if(!this.isVisible())return;if(this._touches.length==1&&this._dragging){this._touchMoved=!0;var n=this.getParent().convertToWorldSpace(this.getPosition()),r=cc.RectMake(n.x,n.y,this._viewSize.width,this._viewSize.height),i=this.convertTouchToNodeSpace(e),s=cc.pSub(i,this._touchPoint);this._touchPoint=i;if(cc.Rect.CCRectContainsPoint(r,this.convertToWorldSpace(i))){switch(this._direction){case cc.SCROLLVIEW_DIRECTION_VERTICAL:s=cc.p(0,s.y);break;case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:s=cc.p(s.x,0);break;default:}var o=this._container.getPosition().x+s.x,u=this._container.getPosition().y+s.y;this._scrollDistance=s,this.setContentOffset(cc.p(o,u))}}else if(this._touches.length==2&&!this._dragging){var a=cc.pDistance(this._container.convertTouchToNodeSpace(this._touches[0]),this._container.convertTouchToNodeSpace(this._touches[1]));this.setZoomScale(this.getZoomScale()*a/this._touchLength)}},onTouchEnded:function(e,t){if(!this.isVisible())return;this._touches.length==1&&this._touchMoved&&this.schedule(this._deaccelerateScrolling),this._touches.length=0,this._dragging=!1,this._touchMoved=!1},onTouchCancelled:function(e,t){if(!this.isVisible())return;this._touches.length=0,this._dragging=!1,this._touchMoved=!1},setContentSize:function(e,t){t!=null&&t==1?this._super(e):this.getContainer()!=null&&(this.getContainer().setContentSize(e),this.updateInset())},getContentSize:function(){return this._container.getContentSize()},updateInset:function(){this.getContainer()!=null&&(this._maxInset=this.maxContainerOffset(),this._maxInset=cc.p(this._maxInset.x+this._viewSize.width*INSET_RATIO,this._maxInset.y+this._viewSize.height*INSET_RATIO),this._minInset=this.minContainerOffset(),this._minInset=cc.p(this._minInset.x-this._viewSize.width*INSET_RATIO,this._minInset.y-this._viewSize.height*INSET_RATIO))},isClippingToBounds:function(){return this._clippingToBounds},setClippingToBounds:function(e){this._clippingToBounds=e},visit:function(e){if(!this.isVisible())return;var t=e||cc.renderContext,n;if(cc.renderContextType==cc.CANVAS){t.save(),this.transform(t),this._beforeDraw(t);if(this._children&&this._children.length>0){this.sortAllChildren();for(n=0;n<this._children.length;n++){if(!(this._children[n]&&this._children[n]._zOrder<0))break;this._children[n].visit(t)}this.draw(t);if(this._children)for(;n<this._children.length;n++)this._children[n]&&this._children[n]._zOrder>=0&&this._children[n].visit(t)}else this.draw(t);this._afterDraw(),t.restore()}else{cc.kmGLPushMatrix(),this._grid&&this._grid.isActive()&&(this._grid.beforeDraw(),this.transformAncestors()),this.transform(t),this._beforeDraw(t);if(this._children){n=0;for(;n<this._children.length;n++){if(!(this._children[n].getZOrder()<0))break;this._children[n].visit(t)}this.draw(t);for(;n<this._children.length;n++)this._children[n].visit(t)}else this.draw(t);this._afterDraw(t),this._grid&&this._grid.isActive()&&this._grid.afterDraw(this),cc.kmGLPopMatrix()}},addChild:function(e,t,n){if(!e)throw new Error("child must not nil!");t=t||e.getZOrder(),n=n||e.getTag(),e.ignoreAnchorPointForPosition(!1),e.setAnchorPoint(cc.p(0,0)),this._container!=e?this._container.addChild(e,t,n):this._super(e,t,n)},setTouchEnabled:function(e){this._super(e),e||(this._dragging=!1,this._touchMoved=!1,this._touches.length=0)},_initWithViewSize:function(e){return null},_relocateContainer:function(e){var t=this.minContainerOffset(),n=this.maxContainerOffset(),r=this._container.getPosition(),i=r.x,s=r.y;if(this._direction==cc.SCROLLVIEW_DIRECTION_BOTH||this._direction==cc.SCROLLVIEW_DIRECTION_HORIZONTAL)i=Math.min(i,n.x),i=Math.max(i,t.x);if(this._direction==cc.SCROLLVIEW_DIRECTION_BOTH||this._direction==cc.SCROLLVIEW_DIRECTION_VERTICAL)s=Math.min(s,n.y),s=Math.max(s,t.y);(s!=r.y||i!=r.x)&&this.setContentOffset(cc.p(i,s),e)},_deaccelerateScrolling:function(e){if(this._dragging){this.unschedule(this._deaccelerateScrolling);return}var t,n;this._container.setPosition(cc.pAdd(this._container.getPosition(),this._scrollDistance)),this._bounceable?(t=this._maxInset,n=this._minInset):(t=this.maxContainerOffset(),n=this.minContainerOffset());var r=this._container.getPosition().x,i=this._container.getPosition().y;this._scrollDistance=cc.pSub(this._scrollDistance,cc.p(r-this._container.getPosition().x,i-this._container.getPosition().y)),this._scrollDistance=cc.pMult(this._scrollDistance,SCROLL_DEACCEL_RATE),this.setContentOffset(cc.p(r,i));if(Math.abs(this._scrollDistance.x)<=SCROLL_DEACCEL_DIST&&Math.abs(this._scrollDistance.y)<=SCROLL_DEACCEL_DIST||r==t.x||r==n.x||i==t.y||i==n.y)this.unschedule(this._deaccelerateScrolling),this._relocateContainer(!0)},_performedAnimatedScroll:function(e){if(this._dragging){this.unschedule(this._performedAnimatedScroll);return}this._delegate!=null&&this._delegate.scrollViewDidScroll(this)},_stoppedAnimatedScroll:function(e){this.unschedule(this._performedAnimatedScroll),this._delegate!=null&&this._delegate.scrollViewDidScroll(this)},_beforeDraw:function(e){if(this._clippingToBounds){var t,n=this.getScale(),r=e||cc.renderContext;if(cc.renderContextType==cc.CANVAS){t=this.getParent().getPosition();var i=this._viewSize.width*n,s=this._viewSize.height*n,o=t.x*n,u=t.y*n;r.beginPath(),r.rect(o,u,i,-s),r.clip(),r.closePath()}else t=this.convertToWorldSpace(this.getParent().getPosition()),r.enable(r.SCISSOR_TEST),cc.EGLView.getInstance().setScissorInPoints(t.x*n,t.y*n,this._viewSize.width*n,this._viewSize.height*n)}},_afterDraw:function(e){if(this._clippingToBounds&&cc.renderContextType===cc.WEBGL){var t=e||cc.renderContext;t.disable(t.SCISSOR_TEST)}},_handleZoom:function(){}}),cc.ScrollView.create=function(e,t){var n=new cc.ScrollView;if(arguments.length==2){if(n&&n.initWithViewSize(e,t))return n}else if(n&&n.init())return n;return null};cc.SortableObject=cc.Class.extend({setObjectID:function(e){},getObjectID:function(){return 0}}),cc.SortedObject=cc.SortableObject.extend({_objectID:0,ctor:function(){this._objectID=0},setObjectID:function(e){this._objectID=e},getObjectID:function(){return this._objectID}});var _compareObject=function(e,t){return e.getObjectID()-t.getObjectID()};cc.ArrayForObjectSorting=cc.Class.extend({_saveObjectArr:[],ctor:function(){this._saveObjectArr=[]},insertSortedObject:function(e){cc.Assert(e instanceof cc.Class,"Invalid parameter.");var t=this.indexOfSortedObject(e);this.insertObject(e,t)},removeSortedObject:function(e){if(this.count()==0)return;var t=this.indexOfSortedObject(e);if(t<this.count()&&t!=cc.INVALID_INDEX){var n=this.objectAtIndex(t);n.getObjectID()==e.getObjectID()&&this.removeObjectAtIndex(t)}},setObjectID_ofSortedObject:function(e,t){var n=this.indexOfSortedObject(t);if(n<this.count()&&n!=cc.INVALID_INDEX){var r=this.objectAtIndex(n);r.getObjectID()==t.getObjectID()&&(this.removeObjectAtIndex(n),r.setObjectID(e),this.insertSortedObject(r))}},objectWithObjectID:function(e){if(this.count()==0)return null;var t=new cc.SortedObject;t.setObjectID(e);var n=this.indexOfSortedObject(t);return n<this.count()&&n!=cc.INVALID_INDEX&&(t=this.objectAtIndex(n),t.getObjectID()!=e&&(t=null)),t},getObjectWithObjectID:function(e){return null},indexOfSortedObject:function(e){var t=0;if(e){var n=0,r=e.getObjectID();for(var i=0;i<this._saveObjectArr.length;i++){var s=this._saveObjectArr[i],o=s.getObjectID();if(r==o||r>=n&&r<o)break;n=o,t++}}else t=cc.INVALID_INDEX;return t},count:function(){return this._saveObjectArr.length},lastObject:function(){return this._saveObjectArr.length==0?null:this._saveObjectArr[this._saveObjectArr.length-1]},objectAtIndex:function(e){return this._saveObjectArr[e]},addObject:function(e){this._saveObjectArr.push(e),this._saveObjectArr.sort(_compareObject)},removeObjectAtIndex:function(e){cc.ArrayRemoveObjectAtIndex(this._saveObjectArr,e),this._saveObjectArr.sort(_compareObject)},insertObject:function(e,t){this._saveObjectArr=cc.ArrayAppendObjectToIndex(this._saveObjectArr,e,t),this._saveObjectArr.sort(_compareObject)}});cc.TABLEVIEW_FILL_TOPDOWN=0,cc.TABLEVIEW_FILL_BOTTOMUP=1,cc.TableViewCell=cc.Node.extend({_idx:0,getIdx:function(){return this._idx},setIdx:function(e){this._idx=e},reset:function(){this._idx=cc.INVALID_INDEX},setObjectID:function(e){this._idx=e},getObjectID:function(){return this._idx}}),cc.TableViewDelegate=cc.ScrollViewDelegate.extend({tableCellTouched:function(e,t){}}),cc.TableViewDataSource=cc.Class.extend({cellSizeForTable:function(e){return 0},tableCellAtIndex:function(e,t){return 0},numberOfCellsInTableView:function(e){return 0}}),cc.TableView=cc.ScrollView.extend({_vOrdering:null,_indices:null,_cellsFreed:null,_dataSource:null,_tableViewDelegate:null,_oldDirection:null,ctor:function(){this._super(),this._oldDirection=cc.SCROLLVIEW_DIRECTION_NONE},__indexFromOffset:function(e){var t=0,n=this._dataSource.cellSizeForTable(this);switch(this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:t=e.x/n.width;break;default:t=e.y/n.height}return t},_indexFromOffset:function(e){var t=this._dataSource.numberOfCellsInTableView(this)-1,n=new cc.Point(e.x,e.y),r=this._dataSource.cellSizeForTable(this);this._vOrdering==cc.TABLEVIEW_FILL_TOPDOWN&&(n.y=this.getContainer().getContentSize().height-e.y-r.height);var i=Math.max(0,this.__indexFromOffset(n));return i=Math.min(i,t),i},__offsetFromIndex:function(e){var t,n;n=this._dataSource.cellSizeForTable(this);switch(this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:t=cc.p(n.width*e,0);break;default:t=cc.p(0,n.height*e)}return t},_offsetFromIndex:function(e){var t=this.__offsetFromIndex(e),n=this._dataSource.cellSizeForTable(this);return this._vOrdering==cc.TABLEVIEW_FILL_TOPDOWN&&(t.y=this.getContainer().getContentSize().height-t.y-n.height),t},_updateContentSize:function(){var e,t=this._dataSource.cellSizeForTable(this),n=this._dataSource.numberOfCellsInTableView(this);switch(this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:e=cc.SizeMake(n*t.width,t.height);break;default:e=cc.SizeMake(t.width,n*t.height)}this.setContentSize(e),this._oldDirection!=this._direction&&(this._direction==cc.SCROLLVIEW_DIRECTION_HORIZONTAL?this.setContentOffset(cc.p(0,0)):this.setContentOffset(cc.p(0,this.minContainerOffset().y)),this._oldDirection=this._direction)},_cellWithIndex:function(e){var t=null;return this._indices.containsObject(e)&&(t=this._cellsUsed.objectWithObjectID(e)),t},_moveCellOutOfSight:function(e){this._cellsFreed.addObject(e),this._cellsUsed.removeSortedObject(e),this._indices.removeObject(e.getIdx()),e.reset(),e.getParent()==this.getContainer()&&this.getContainer().removeChild(e,!0)},_setIndexForCell:function(e,t){t.setAnchorPoint(cc.p(0,0)),t.setPosition(this._offsetFromIndex(e)),t.setIdx(e)},_addCellIfNecessary:function(e){e.getParent()!=this.getContainer()&&this.getContainer().addChild(e),this._cellsUsed.insertSortedObject(e),this._indices.addObject(e.getIdx())},getDataSource:function(){return this._dataSource},setDataSource:function(e){this._dataSource=e},getDelegate:function(){return this._tableViewDelegate},setDelegate:function(e,t){if(t!=null&&t==1){this._super(e);return}this._tableViewDelegate=e},setVerticalFillOrder:function(e){this._vOrdering!=e&&(this._vOrdering=e,this._cellsUsed.count()>0&&this.reloadData())},getVerticalFillOrder:function(){return this._vOrdering},initWithViewSize:function(e,t){return this._super(e,t)?(this._cellsUsed=new cc.ArrayForObjectSorting,this._cellsFreed=new cc.ArrayForObjectSorting,this._indices=new cc.Set,this._tableViewDelegate=null,this._vOrdering=cc.TABLEVIEW_FILL_BOTTOMUP,this.setDirection(cc.SCROLLVIEW_DIRECTION_VERTICAL),this.setDelegate(this,!0),!0):!1},updateCellAtIndex:function(e){if(e==cc.INVALID_INDEX||e>this._dataSource.numberOfCellsInTableView(this)-1)return;var t=this._cellWithIndex(e);t&&this._moveCellOutOfSight(t),t=this._dataSource.tableCellAtIndex(this,e),this._setIndexForCell(e,t),this._addCellIfNecessary(t)},insertCellAtIndex:function(e){if(e==cc.INVALID_INDEX||e>this._dataSource.numberOfCellsInTableView(this)-1)return;var t,n=this._cellsUsed.objectWithObjectID(e);if(n){t=this._cellsUsed.indexOfSortedObject(n);for(var r=t;r<this._cellsUsed.count();r++)n=this._cellsUsed.objectAtIndex(r),this._setIndexForCell(n.getIdx()+1,n)}n=this._dataSource.tableCellAtIndex(this,e),this._setIndexForCell(e,n),this._addCellIfNecessary(n),this._updateContentSize()},removeCellAtIndex:function(e){if(e==cc.INVALID_INDEX||e>this._dataSource.numberOfCellsInTableView(this)-1)return;var t=this._cellWithIndex(e);if(!t)return;var n=this._cellsUsed.indexOfSortedObject(t);this._moveCellOutOfSight(t),this._indices.removeObject(e);for(var r=this._cellsUsed.count()-1;r>n;r--)t=this._cellsUsed.objectAtIndex(r),this._setIndexForCell(t.getIdx()-1,t)},reloadData:function(){for(var e=0;e<this._cellsUsed.count();e++){var t=this._cellsUsed.objectAtIndex(e);this._cellsFreed.addObject(t),t.reset(),t.getParent()==this.getContainer()&&this.getContainer().removeChild(t,!0)}this._indices=new cc.Set,this._cellsUsed=new cc.ArrayForObjectSorting,this._updateContentSize(),this._dataSource.numberOfCellsInTableView(this)>0&&this.scrollViewDidScroll(this)},dequeueCell:function(){if(this._cellsFreed.count()==0)return null;var e=this._cellsFreed.objectAtIndex(0);return this._cellsFreed.removeObjectAtIndex(0),e},cellAtIndex:function(e){return this._cellWithIndex(e)},scrollViewDidScroll:function(e){var t=this._dataSource.numberOfCellsInTableView(this);if(0===t)return;this._tableViewDelegate!=null&&this._tableViewDelegate.scrollViewDidScroll(this);var n=0,r=cc.pMult(this.getContentOffset(),-1),i=Math.max(this._dataSource.numberOfCellsInTableView(this)-1,0),s=this._dataSource.cellSizeForTable(this);this._vOrdering==cc.TABLEVIEW_FILL_TOPDOWN&&(r.y=r.y+this._viewSize.height/this.getContainer().getScaleY()-s.height);var o=0|this._indexFromOffset(r);this._vOrdering==cc.TABLEVIEW_FILL_TOPDOWN?r.y-=this._viewSize.height/this.getContainer().getScaleY():r.y+=this._viewSize.height/this.getContainer().getScaleY(),r.x+=this._viewSize.width/this.getContainer().getScaleX();var u=0|this._indexFromOffset(r),a;if(this._cellsUsed.count()>0){a=this._cellsUsed.objectAtIndex(0),n=a.getIdx();while(n<o){this._moveCellOutOfSight(a);if(!(this._cellsUsed.count()>0))break;a=this._cellsUsed.objectAtIndex(0),n=a.getIdx()}}if(this._cellsUsed.count()>0){a=this._cellsUsed.lastObject(),n=a.getIdx();while(n<=i&&n>u){this._moveCellOutOfSight(a);if(!(this._cellsUsed.count()>0))break;a=this._cellsUsed.lastObject(),n=a.getIdx()}}for(var f=o;f<=u;f++){if(this._indices.containsObject(f))continue;this.updateCellAtIndex(f)}},scrollViewDidZoom:function(e){},onTouchEnded:function(e,t){if(!this.isVisible())return;if(this._touches.length==1&&!this.isTouchMoved()){var n=this.getContainer().convertTouchToNodeSpace(e);if(this._vOrdering==cc.TABLEVIEW_FILL_TOPDOWN){var r=this._dataSource.cellSizeForTable(this);n.y-=r.height}var i=0|this._indexFromOffset(n),s=this._cellWithIndex(i);s&&this._tableViewDelegate.tableCellTouched(this,s)}this._super(e,t)}}),cc.TableView.create=function(e,t,n){var r=new cc.TableView;return r.initWithViewSize(t,n),r.setDataSource(e),r._updateContentSize(),r};function BlockData(e,t){this.selMenuHander=e,this.target=t}function BlockCCControlData(e,t,n){this.selCCControlHandler=e,this.target=t,this.controlEvents=n}var PROPERTY_POSITION="position",PROPERTY_CONTENTSIZE="contentSize",PROPERTY_SKEW="skew",PROPERTY_ANCHORPOINT="anchorPoint",PROPERTY_SCALE="scale",PROPERTY_ROTATION="rotation",PROPERTY_TAG="tag",PROPERTY_IGNOREANCHORPOINTFORPOSITION="ignoreAnchorPointForPosition",PROPERTY_VISIBLE="visible",ASSERT_FAIL_UNEXPECTED_PROPERTY=function(e){cc.log("Unexpected property: '"+e+"'!"),cc.Assert(!1,"Unexpected property: '"+e+"'!")},ASSERT_FAIL_UNEXPECTED_PROPERTYTYPE=function(e){cc.log("Unexpected property type: '"+e+"'!"),cc.Assert(!1,"Unexpected property type: '"+e+"'!")};cc.NodeLoader=cc.Class.extend({_customProperties:null,ctor:function(){this._customProperties=new cc._Dictionary},loadCCNode:function(e,t){return this._createCCNode(e,t)},parseProperties:function(e,t,n){var r=n.readInt(!1),i=n.readInt(!1),s=r+i;for(var o=0;o<s;o++){var u=o>=r,a=n.readInt(!1),f=n.readCachedString(),l=!1,c=n.readByte();if(c==CCB_PLATFORM_ALL||c==CCB_PLATFORM_IOS||c==CCB_PLATFORM_MAC)l=!0;if(e instanceof cc.BuilderFile){if(e.getCCBFileNode()&&u){e=e.getCCBFileNode();var h=e.getUserObject();l=cc.ArrayContainsObject(h,f)}}else if(u&&e==n.getAnimationManager().getRootNode()){var p=e.getUserObject();p||(p=[],e.setUserObject(p)),p.push(f)}switch(a){case CCB_PROPTYPE_POSITION:var d=this.parsePropTypePosition(e,t,n,f);l&&this.onHandlePropTypePosition(e,t,f,d,n);break;case CCB_PROPTYPE_POINT:var v=this.parsePropTypePoint(e,t,n);l&&this.onHandlePropTypePoint(e,t,f,v,n);break;case CCB_PROPTYPE_POINTLOCK:var m=this.parsePropTypePointLock(e,t,n);l&&this.onHandlePropTypePointLock(e,t,f,m,n);break;case CCB_PROPTYPE_SIZE:var g=this.parsePropTypeSize(e,t,n);l&&this.onHandlePropTypeSize(e,t,f,g,n);break;case CCB_PROPTYPE_SCALELOCK:var y=this.parsePropTypeScaleLock(e,t,n,f);l&&this.onHandlePropTypeScaleLock(e,t,f,y,n);break;case CCB_PROPTYPE_FLOATXY:var b=this.parsePropTypeFloatXY(e,t,n);l&&this.onHandlePropTypeFloatXY(e,t,f,b,n);break;case CCB_PROPTYPE_FLOAT:var w=this.parsePropTypeFloat(e,t,n);l&&this.onHandlePropTypeFloat(e,t,f,w,n);break;case CCB_PROPTYPE_DEGREES:var E=this.parsePropTypeDegrees(e,t,n,f);l&&this.onHandlePropTypeDegrees(e,t,f,E,n);break;case CCB_PROPTYPE_FLOATSCALE:var S=this.parsePropTypeFloatScale(e,t,n);l&&this.onHandlePropTypeFloatScale(e,t,f,S,n);break;case CCB_PROPTYPE_INTEGER:var x=this.parsePropTypeInteger(e,t,n);l&&this.onHandlePropTypeInteger(e,t,f,x,n);break;case CCB_PROPTYPE_INTEGERLABELED:var T=this.parsePropTypeIntegerLabeled(e,t,n);l&&this.onHandlePropTypeIntegerLabeled(e,t,f,T,n);break;case CCB_PROPTYPE_FLOATVAR:var N=this.parsePropTypeFloatVar(e,t,n);l&&this.onHandlePropTypeFloatVar(e,t,f,N,n);break;case CCB_PROPTYPE_CHECK:var C=this.parsePropTypeCheck(e,t,n,f);l&&this.onHandlePropTypeCheck(e,t,f,C,n);break;case CCB_PROPTYPE_SPRITEFRAME:var k=this.parsePropTypeSpriteFrame(e,t,n,f);l&&this.onHandlePropTypeSpriteFrame(e,t,f,k,n);break;case CCB_PROPTYPE_ANIMATION:var L=this.parsePropTypeAnimation(e,t,n);l&&this.onHandlePropTypeAnimation(e,t,f,L,n);break;case CCB_PROPTYPE_TEXTURE:var A=this.parsePropTypeTexture(e,t,n);l&&this.onHandlePropTypeTexture(e,t,f,A,n);break;case CCB_PROPTYPE_BYTE:var O=this.parsePropTypeByte(e,t,n,f);l&&this.onHandlePropTypeByte(e,t,f,O,n);break;case CCB_PROPTYPE_COLOR3:var M=this.parsePropTypeColor3(e,t,n,f);l&&this.onHandlePropTypeColor3(e,t,f,M,n);break;case CCB_PROPTYPE_COLOR4VAR:var _=this.parsePropTypeColor4FVar(e,t,n);l&&this.onHandlePropTypeColor4FVar(e,t,f,_,n);break;case CCB_PROPTYPE_FLIP:var D=this.parsePropTypeFlip(e,t,n);l&&this.onHandlePropTypeFlip(e,t,f,D,n);break;case CCB_PROPTYPE_BLENDMODE:var P=this.parsePropTypeBlendFunc(e,t,n);l&&this.onHandlePropTypeBlendFunc(e,t,f,P,n);break;case CCB_PROPTYPE_FNTFILE:var H=n.getCCBRootPath()+this.parsePropTypeFntFile(e,t,n);l&&this.onHandlePropTypeFntFile(e,t,f,H,n);break;case CCB_PROPTYPE_FONTTTF:var B=this.parsePropTypeFontTTF(e,t,n);l&&this.onHandlePropTypeFontTTF(e,t,f,B,n);break;case CCB_PROPTYPE_STRING:var j=this.parsePropTypeString(e,t,n);l&&this.onHandlePropTypeString(e,t,f,j,n);break;case CCB_PROPTYPE_TEXT:var F=this.parsePropTypeText(e,t,n);l&&this.onHandlePropTypeText(e,t,f,F,n);break;case CCB_PROPTYPE_BLOCK:var I=this.parsePropTypeBlock(e,t,n);l&&this.onHandlePropTypeBlock(e,t,f,I,n);break;case CCB_PROPTYPE_BLOCKCCCONTROL:var q=this.parsePropTypeBlockCCControl(e,t,n);l&&q!=null&&this.onHandlePropTypeBlockCCControl(e,t,f,q,n);break;case CCB_PROPTYPE_CCBFILE:var R=this.parsePropTypeCCBFile(e,t,n);l&&this.onHandlePropTypeCCBFile(e,t,f,R,n);break;default:ASSERT_FAIL_UNEXPECTED_PROPERTYTYPE(a)}}},getCustomProperties:function(){return this._customProperties},_createCCNode:function(e,t){return cc.Node.create()},parsePropTypePosition:function(e,t,n,r){var i=n.readFloat(),s=n.readFloat(),o=n.readInt(!1),u=n.getAnimationManager().getContainerSize(t),a=cc.getAbsolutePosition(cc.p(i,s),o,u,r);e.setPosition(cc.getAbsolutePosition(a,o,u,r));if(n.getAnimatedProperties().indexOf(r)>-1){var f=[i,s,o];n.getAnimationManager().setBaseValue(f,e,r)}return a},parsePropTypePoint:function(e,t,n){var r=n.readFloat(),i=n.readFloat();return new cc.Point(r,i)},parsePropTypePointLock:function(e,t,n){var r=n.readFloat(),i=n.readFloat();return new cc.Point(r,i)},parsePropTypeSize:function(e,t,n){var r=n.readFloat(),i=n.readFloat(),s=n.readInt(!1),o=n.getAnimationManager().getContainerSize(t);switch(s){case CCB_SIZETYPE_ABSOLUTE:break;case CCB_SIZETYPE_RELATIVE_CONTAINER:r=o.width-r,i=o.height-i;break;case CCB_SIZETYPE_PERCENT:r=o.width*r/100,i=o.height*i/100;break;case CCB_SIZETYPE_HORIZONTAL_PERCENT:r=o.width*r/100;break;case CCB_SIZETYPE_VERTICAL_PERCENT:i=o.height*i/100;break;case CCB_SIZETYPE_MULTIPLY_RESOLUTION:var u=cc.BuilderReader.getResolutionScale();r*=u,i*=u;break;default:cc.log("Unknown CCB type.")}return new cc.Size(r,i)},parsePropTypeScaleLock:function(e,t,n,r){var i=n.readFloat(),s=n.readFloat(),o=n.readInt(!1);return cc.setRelativeScale(e,i,s,o,r),n.getAnimatedProperties().indexOf(r)>-1&&n.getAnimationManager().setBaseValue([i,s,o],e,r),o==CCB_SCALETYPE_MULTIPLY_RESOLUTION&&(i*=cc.BuilderReader.getResolutionScale(),s*=cc.BuilderReader.getResolutionScale()),[i,s]},parsePropTypeFloat:function(e,t,n){return n.readFloat()},parsePropTypeDegrees:function(e,t,n,r){var i=n.readFloat();return n.getAnimatedProperties().indexOf(r)>-1&&n.getAnimationManager().setBaseValue(i,e,r),i},parsePropTypeFloatScale:function(e,t,n){var r=n.readFloat(),i=n.readInt(!1);return i==CCB_SCALETYPE_MULTIPLY_RESOLUTION&&(r*=cc.BuilderReader.getResolutionScale()),r},parsePropTypeInteger:function(e,t,n){return n.readInt(!0)},parsePropTypeIntegerLabeled:function(e,t,n){return n.readInt(!0)},parsePropTypeFloatVar:function(e,t,n){var r=n.readFloat(),i=n.readFloat();return[r,i]},parsePropTypeCheck:function(e,t,n,r){var i=n.readBool();return n.getAnimatedProperties().indexOf(r)>-1&&n.getAnimationManager().setBaseValue(i,e,r),i},parsePropTypeSpriteFrame:function(e,t,n,r){var i=n.readCachedString(),s=n.readCachedString(),o;if(s!=null&&s.length!=0){if(i.length==0){s=n.getCCBRootPath()+s;var u=cc.TextureCache.getInstance().addImage(s),a;u instanceof cc.Texture2D?a=cc.RectMake(0,0,u.getContentSize().width,u.getContentSize().height):a=cc.RectMake(0,0,u.width,u.height),o=cc.SpriteFrame.createWithTexture(u,a)}else{var f=cc.SpriteFrameCache.getInstance();i=n.getCCBRootPath()+i,n.getLoadedSpriteSheet().indexOf(i)==-1&&(f.addSpriteFrames(i),n.getLoadedSpriteSheet().push(i)),o=f.getSpriteFrame(s)}n.getAnimatedProperties().indexOf(r)>-1&&n.getAnimationManager().setBaseValue(o,e,r)}return o},parsePropTypeAnimation:function(e,t,n){var r=n.getCCBRootPath()+n.readCachedString(),i=n.readCachedString(),s=null;i=cc.BuilderReader.lastPathComponent(i),r=cc.BuilderReader.lastPathComponent(r);if(i!=null&&i!=""){var o=cc.AnimationCache.getInstance();o.addAnimations(r),s=o.getAnimation(i)}return s},parsePropTypeTexture:function(e,t,n){var r=n.getCCBRootPath()+n.readCachedString();return r!=""?cc.TextureCache.getInstance().addImage(r):null},parsePropTypeByte:function(e,t,n,r){var i=n.readByte();return n.getAnimatedProperties().indexOf(r)>-1&&n.getAnimationManager().setBaseValue(i,e,r),i},parsePropTypeColor3:function(e,t,n,r){var i=n.readByte(),s=n.readByte(),o=n.readByte(),u={r:i,g:s,b:o};return n.getAnimatedProperties().indexOf(r)>-1&&n.getAnimationManager().setBaseValue(cc.Color3BWapper.create(u),e,r),u},parsePropTypeColor4FVar:function(e,t,n){var r=n.readFloat(),i=n.readFloat(),s=n.readFloat(),o=n.readFloat(),u=n.readFloat(),a=n.readFloat(),f=n.readFloat(),l=n.readFloat(),c=[];return c[0]={r:r,g:i,b:s,a:o},c[1]={r:u,g:a,b:f,a:l},c},parsePropTypeFlip:function(e,t,n){var r=n.readBool(),i=n.readBool();return[r,i]},parsePropTypeBlendFunc:function(e,t,n){var r=n.readInt(!1),i=n.readInt(!1);return new cc.BlendFunc(r,i)},parsePropTypeFntFile:function(e,t,n){return n.readCachedString()},parsePropTypeString:function(e,t,n){return n.readCachedString()},parsePropTypeText:function(e,t,n){return n.readCachedString()},parsePropTypeFontTTF:function(e,t,n){return n.readCachedString()},parsePropTypeBlock:function(e,t,n){var r=n.readCachedString(),i=n.readInt(!1);if(i!=CCB_TARGETTYPE_NONE){var s=null;if(!n.isJSControlled()){i==CCB_TARGETTYPE_DOCUMENTROOT?s=n.getAnimationManager().getRootNode():i==CCB_TARGETTYPE_OWNER&&(s=n.getOwner());if(s!=null)if(r.length>0){var o=0;s!=null&&s.onResolveCCBCCMenuItemSelector&&(o=s.onResolveCCBCCMenuItemSelector(s,r));if(o==0){var u=n.getCCBSelectorResolver();u!=null&&(o=u.onResolveCCBCCMenuItemSelector(s,r))}if(o!=0)return new BlockData(o,s);cc.log("Skipping selector '"+r+"' since no CCBSelectorResolver is present.")}else cc.log("Unexpected empty selector.");else cc.log("Unexpected NULL target for selector.")}else i==CCB_TARGETTYPE_DOCUMENTROOT?(n.addDocumentCallbackNode(e),n.addDocumentCallbackName(r)):(n.addOwnerCallbackNode(e),n.addOwnerCallbackName(r))}return null},parsePropTypeBlockCCControl:function(e,t,n){var r=n.readCachedString(),i=n.readInt(!1),s=n.readInt(!1);if(i!=CCB_TARGETTYPE_NONE)if(!n.isJSControlled()){var o=null;i==CCB_TARGETTYPE_DOCUMENTROOT?o=n.getAnimationManager().getRootNode():i==CCB_TARGETTYPE_OWNER&&(o=n.getOwner());if(o!=null)if(r.length>0){var u=0;o!=null&&o.onResolveCCBCCControlSelector&&(u=o.onResolveCCBCCControlSelector(o,r));if(u==0){var a=n.getCCBSelectorResolver();a!=null&&(u=a.onResolveCCBCCControlSelector(o,r))}if(u!=0)return new BlockCCControlData(u,o,s);cc.log("Skipping selector '"+r+"' since no CCBSelectorResolver is present.")}else cc.log("Unexpected empty selector.");else cc.log("Unexpected NULL target for selector.")}else i==CCB_TARGETTYPE_DOCUMENTROOT?(n.addDocumentCallbackName(e),n.addDocumentCallbackName(r)):(n.addOwnerCallbackNode(e),n.addOwnerCallbackName(r));return null},parsePropTypeCCBFile:function(e,t,n){var r=n.getCCBRootPath()+n.readCachedString(),i=cc.BuilderReader.deletePathExtension(r);r=i+".ccbi";var s=cc.FileUtils.getInstance().fullPathFromRelativePath(r),o=new cc.BuilderReader(n),u,a=cc.FileUtils.getInstance().getByteArrayFromFile(s,"rb",u);o.initWithData(a,n.getOwner()),o.getAnimationManager().setRootContainerSize(t.getContentSize()),o.setAnimationManagers(n.getAnimationManagers()),o.getAnimationManager().setOwner(n.getOwner());var f=o.readFileWithCleanUp(!1);return n.setAnimationManagers(o.getAnimationManagers()),f&&o.getAnimationManager().getAutoPlaySequenceId()!=-1&&o.getAnimationManager().runAnimations(o.getAnimationManager().getAutoPlaySequenceId(),0),f},parsePropTypeFloatXY:function(e,t,n){var r=n.readFloat(),i=n.readFloat();return[r,i]},onHandlePropTypePosition:function(e,t,n,r,i){n===PROPERTY_POSITION?e.setPosition(r):ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypePoint:function(e,t,n,r,i){n===PROPERTY_ANCHORPOINT?e.setAnchorPoint(r):ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypePointLock:function(e,t,n,r,i){ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypeSize:function(e,t,n,r,i){n===PROPERTY_CONTENTSIZE?e.setContentSize(r):ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypeScaleLock:function(e,t,n,r,i){n===PROPERTY_SCALE?(e.setScaleX(r[0]),e.setScaleY(r[1])):ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypeFloatXY:function(e,t,n,r,i){if(n===PROPERTY_SKEW)e.setSkewX(r[0]),e.setSkewY(r[1]);else{var s=n+"X",o=n+"Y";(!e[s]||!e[o])&&ASSERT_FAIL_UNEXPECTED_PROPERTY(n),e[s](r[0]),e[o](r[1])}},onHandlePropTypeFloat:function(e,t,n,r,i){this._customProperties.setObject(r,n)},onHandlePropTypeDegrees:function(e,t,n,r,i){n===PROPERTY_ROTATION?e.setRotation(r):ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypeFloatScale:function(e,t,n,r,i){ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypeInteger:function(e,t,n,r,i){n===PROPERTY_TAG?e.setTag(r):ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypeIntegerLabeled:function(e,t,n,r,i){ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypeFloatVar:function(e,t,n,r,i){ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypeCheck:function(e,t,n,r,i){n===PROPERTY_VISIBLE?e.setVisible(r):n==PROPERTY_IGNOREANCHORPOINTFORPOSITION?e.ignoreAnchorPointForPosition(r):ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypeSpriteFrame:function(e,t,n,r,i){ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypeAnimation:function(e,t,n,r,i){ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypeTexture:function(e,t,n,r,i){ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypeByte:function(e,t,n,r,i){ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypeColor3:function(e,t,n,r,i){ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypeColor4FVar:function(e,t,n,r,i){ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypeFlip:function(e,t,n,r,i){ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypeBlendFunc:function(e,t,n,r,i){ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypeFntFile:function(e,t,n,r,i){ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypeString:function(e,t,n,r,i){this._customProperties.setObject(r,n)},onHandlePropTypeText:function(e,t,n,r,i){ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypeFontTTF:function(e,t,n,r,i){ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypeBlock:function(e,t,n,r,i){ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypeBlockCCControl:function(e,t,n,r,i){ASSERT_FAIL_UNEXPECTED_PROPERTY(n)},onHandlePropTypeCCBFile:function(e,t,n,r,i){ASSERT_FAIL_UNEXPECTED_PROPERTY(n)}}),cc.NodeLoader.loader=function(){return new cc.NodeLoader};cc.NodeLoaderListener=cc.Class.extend({onNodeLoaded:function(e,t){}}),cc.BuilderSelectorResolver=cc.Class.extend({onResolveCCBCCMenuItemSelector:function(e,t){},onResolveCCBCCCallFuncSelector:function(e,t){},onResolveCCBCCControlSelector:function(e,t){}}),cc.BuilderScriptOwnerProtocol=cc.Class.extend({createNew:function(){}}),cc.BuilderMemberVariableAssigner=cc.Class.extend({onAssignCCBMemberVariable:function(e,t,n){},onAssignCCBCustomProperty:function(e,t,n){}});var PROPERTY_CCBFILE="ccbFile";cc.BuilderFileLoader=cc.NodeLoader.extend({_createCCNode:function(e,t){return cc.BuilderFile.create()},onHandlePropTypeCCBFile:function(e,t,n,r,i){n==PROPERTY_CCBFILE?e.setCCBFileNode(r):this._super(e,t,n,r,i)}}),cc.BuilderFileLoader.loader=function(){return new cc.BuilderFileLoader};var PROPERTY_ENABLED="enabled",PROPERTY_SELECTED="selected",PROPERTY_CCCONTROL="ccControl";cc.ControlLoader=cc.NodeLoader.extend({_createCCNode:function(e,t){},onHandlePropTypeBlockCCControl:function(e,t,n,r,i){n==PROPERTY_CCCONTROL?e.addTargetWithActionForControlEvents(r.target,r.selCCControlHandler,r.controlEvents):this._super(e,t,n,r,i)},onHandlePropTypeCheck:function(e,t,n,r,i){n==PROPERTY_ENABLED?e.setEnabled(r):n==PROPERTY_SELECTED?e.setSelected(r):this._super(e,t,n,r,i)}});var PROPERTY_ZOOMONTOUCHDOWN="zoomOnTouchDown",PROPERTY_TITLE_NORMAL="title|1",PROPERTY_TITLE_HIGHLIGHTED="title|2",PROPERTY_TITLE_DISABLED="title|3",PROPERTY_TITLECOLOR_NORMAL="titleColor|1",PROPERTY_TITLECOLOR_HIGHLIGHTED="titleColor|2",PROPERTY_TITLECOLOR_DISABLED="titleColor|3",PROPERTY_TITLETTF_NORMAL="titleTTF|1",PROPERTY_TITLETTF_HIGHLIGHTED="titleTTF|2",PROPERTY_TITLETTF_DISABLED="titleTTF|3",PROPERTY_TITLETTFSIZE_NORMAL="titleTTFSize|1",PROPERTY_TITLETTFSIZE_HIGHLIGHTED="titleTTFSize|2",PROPERTY_TITLETTFSIZE_DISABLED="titleTTFSize|4",PROPERTY_LABELANCHORPOINT="labelAnchorPoint",PROPERTY_PREFEREDSIZE="preferedSize",PROPERTY_BACKGROUNDSPRITEFRAME_NORMAL="backgroundSpriteFrame|1",PROPERTY_BACKGROUNDSPRITEFRAME_HIGHLIGHTED="backgroundSpriteFrame|2",PROPERTY_BACKGROUNDSPRITEFRAME_DISABLED="backgroundSpriteFrame|3";cc.ControlButtonLoader=cc.ControlLoader.extend({_createCCNode:function(e,t){return cc.ControlButton.create()},onHandlePropTypeCheck:function(e,t,n,r,i){n==PROPERTY_ZOOMONTOUCHDOWN?e.setZoomOnTouchDown(r):this._super(e,t,n,r,i)},onHandlePropTypeString:function(e,t,n,r,i){n==PROPERTY_TITLE_NORMAL?e.setTitleForState(r,cc.CONTROL_STATE_NORMAL):n==PROPERTY_TITLE_HIGHLIGHTED?e.setTitleForState(r,cc.CONTROL_STATE_HIGHLIGHTED):n==PROPERTY_TITLE_DISABLED?e.setTitleForState(r,cc.CONTROL_STATE_DISABLED):this._super(e,t,n,r,i)},onHandlePropTypeFontTTF:function(e,t,n,r,i){n==PROPERTY_TITLETTF_NORMAL?e.setTitleTTFForState(r,cc.CONTROL_STATE_NORMAL):n==PROPERTY_TITLETTF_HIGHLIGHTED?e.setTitleTTFForState(r,cc.CONTROL_STATE_HIGHLIGHTED):n==PROPERTY_TITLETTF_DISABLED?e.setTitleTTFForState(r,cc.CONTROL_STATE_DISABLED):this._super(e,t,n,r,i)},onHandlePropTypeFloatScale:function(e,t,n,r,i){n==PROPERTY_TITLETTFSIZE_NORMAL?e.setTitleTTFSizeForState(r,cc.CONTROL_STATE_NORMAL):n==PROPERTY_TITLETTFSIZE_HIGHLIGHTED?e.setTitleTTFSizeForState(r,cc.CONTROL_STATE_HIGHLIGHTED):n==PROPERTY_TITLETTFSIZE_DISABLED?e.setTitleTTFSizeForState(r,cc.CONTROL_STATE_DISABLED):this._super(e,t,n,r,i)},onHandlePropTypePoint:function(e,t,n,r,i){n==PROPERTY_LABELANCHORPOINT?e.setLabelAnchorPoint(r):this._super(e,t,n,r,i)},onHandlePropTypeSize:function(e,t,n,r,i){n==PROPERTY_PREFEREDSIZE?e.setPreferredSize(r):this._super(e,t,n,r,i)},onHandlePropTypeSpriteFrame:function(e,t,n,r,i){n==PROPERTY_BACKGROUNDSPRITEFRAME_NORMAL?r!=null&&e.setBackgroundSpriteFrameForState(r,cc.CONTROL_STATE_NORMAL):n==PROPERTY_BACKGROUNDSPRITEFRAME_HIGHLIGHTED?r!=null&&e.setBackgroundSpriteFrameForState(r,cc.CONTROL_STATE_HIGHLIGHTED):n==PROPERTY_BACKGROUNDSPRITEFRAME_DISABLED?r!=null&&e.setBackgroundSpriteFrameForState(r,cc.CONTROL_STATE_DISABLED):this._super(e,t,n,r,i)},onHandlePropTypeColor3:function(e,t,n,r,i){n==PROPERTY_TITLECOLOR_NORMAL?e.setTitleColorForState(r,cc.CONTROL_STATE_NORMAL):n==PROPERTY_TITLECOLOR_HIGHLIGHTED?e.setTitleColorForState(r,cc.CONTROL_STATE_HIGHLIGHTED):n==PROPERTY_TITLECOLOR_DISABLED?e.setTitleColorForState(r,cc.CONTROL_STATE_DISABLED):this._super(e,t,n,r,i)}}),cc.ControlButtonLoader.loader=function(){return new cc.ControlButtonLoader};var PROPERTY_CONTAINER="container",PROPERTY_DIRECTION="direction",PROPERTY_CLIPSTOBOUNDS="clipsToBounds",PROPERTY_BOUNCES="bounces",PROPERTY_SCALE="scale";cc.ScrollViewLoader=cc.NodeLoader.extend({_createCCNode:function(e,t){return cc.ScrollView.create()},onHandlePropTypeSize:function(e,t,n,r,i){n==PROPERTY_CONTENTSIZE?e.setViewSize(r):this._super(e,t,n.size,i)},onHandlePropTypeCCBFile:function(e,t,n,r,i){n==PROPERTY_CONTAINER?(e.setContainer(r),e.updateInset()):this._super(e,t,n,r,i)},onHandlePropTypeCheck:function(e,t,n,r,i){n==PROPERTY_CLIPSTOBOUNDS?e.setClippingToBounds(r):n==PROPERTY_BOUNCES?e.setBounceable(r):this._super(e,t,n,r,i)},onHandlePropTypeFloat:function(e,t,n,r,i){n==PROPERTY_SCALE?e.setScale(r):this._super(e,t,n,r,i)},onHandlePropTypeIntegerLabeled:function(e,t,n,r,i){n==PROPERTY_DIRECTION?e.setDirection(r):this._super(e,t,n,r,i)}}),cc.ScrollViewLoader.loader=function(){return new cc.ScrollViewLoader};var PROPERTY_CONTENTSIZE="contentSize",PROPERTY_SPRITEFRAME="spriteFrame",PROPERTY_COLOR="color",PROPERTY_OPACITY="opacity",PROPERTY_BLENDFUNC="blendFunc",PROPERTY_INSETLEFT="insetLeft",PROPERTY_INSETTOP="insetTop",PROPERTY_INSETRIGHT="insetRight",PROPERTY_INSETBOTTOM="insetBottom";cc.Scale9SpriteLoader=cc.NodeLoader.extend({_createCCNode:function(e,t){return cc.Scale9Sprite.create()},onHandlePropTypeColor3:function(e,t,n,r,i){n==PROPERTY_COLOR?e.setColor(r):this._super(e,t,n,r,i)},onHandlePropTypeByte:function(e,t,n,r,i){n==PROPERTY_OPACITY?e.setOpacity(r):this._super(e,t,n,r,i)},onHandlePropTypeBlendFunc:function(e,t,n,r,i){n!=PROPERTY_BLENDFUNC&&this._super(e,t,n,r,i)},onHandlePropTypeSpriteFrame:function(e,t,n,r,i){n==PROPERTY_SPRITEFRAME?e.initWithSpriteFrame(r):this._super(e,t,n,r,i)},onHandlePropTypeSize:function(e,t,n,r,i){n!=PROPERTY_CONTENTSIZE&&(n==PROPERTY_PREFEREDSIZE?e.setPreferredSize(r):this._super(e,t,n,r,i))},onHandlePropTypeFloat:function(e,t,n,r,i){n==PROPERTY_INSETLEFT?e.setInsetLeft(r):n==PROPERTY_INSETTOP?e.setInsetTop(r):n==PROPERTY_INSETRIGHT?e.setInsetRight(r):n==PROPERTY_INSETBOTTOM?e.setInsetBottom(r):this._super(e,t,n,r,i)}}),cc.Scale9SpriteLoader.loader=function(){return new cc.Scale9SpriteLoader};var PROPERTY_FLIP="flip",PROPERTY_DISPLAYFRAME="displayFrame",PROPERTY_COLOR="color",PROPERTY_OPACITY="opacity",PROPERTY_BLENDFUNC="blendFunc";cc.SpriteLoader=cc.NodeLoader.extend({_createCCNode:function(e,t){return cc.Sprite.create()},onHandlePropTypeColor3:function(e,t,n,r,i){n==PROPERTY_COLOR?e.setColor(r):this._super(e,t,n,r,i)},onHandlePropTypeByte:function(e,t,n,r,i){n==PROPERTY_OPACITY?e.setOpacity(r):this._super(e,t,n,r,i)},onHandlePropTypeBlendFunc:function(e,t,n,r,i){n==PROPERTY_BLENDFUNC?e.setBlendFunc(r):this._super(e,t,n,r,i)},onHandlePropTypeSpriteFrame:function(e,t,n,r,i){n==PROPERTY_DISPLAYFRAME?e.setDisplayFrame(r):this._super(e,t,n,r,i)},onHandlePropTypeFlip:function(e,t,n,r,i){n==PROPERTY_FLIP?(e.setFlipX(r[0]),e.setFlipY(r[1])):this._super(e,t,n,r,i)}}),cc.SpriteLoader.loader=function(){return new cc.SpriteLoader};var PROPERTY_TOUCH_ENABLED="touchEnabled",PROPERTY_ACCELEROMETER_ENABLED="accelerometerEnabled",PROPERTY_IS_MOUSE_ENABLED="isMouseEnabled",PROPERTY_MOUSE_ENABLED="mouseEnabled",PROPERTY_KEYBOARD_ENABLED="keyboardEnabled";cc.LayerLoader=cc.NodeLoader.extend({_createCCNode:function(e,t){return cc.Layer.create()},onHandlePropTypeCheck:function(e,t,n,r,i){n==PROPERTY_TOUCH_ENABLED?e.setTouchEnabled(r):n==PROPERTY_ACCELEROMETER_ENABLED?e.setAccelerometerEnabled(r):n==PROPERTY_IS_MOUSE_ENABLED||n==PROPERTY_MOUSE_ENABLED?e.setMouseEnabled(r):n==PROPERTY_KEYBOARD_ENABLED?e.setKeyboardEnabled&&sys.platform=="browser"?e.setKeyboardEnabled(r):cc.log("The property '"+PROPERTY_KEYBOARD_ENABLED+"' is not supported!"):this._super(e,t,n,r,i)}}),cc.LayerLoader.loader=function(){return new cc.LayerLoader},cc.LayerColorLoader=cc.LayerLoader.extend({_createCCNode:function(e,t){return cc.LayerColor.create()},onHandlePropTypeColor3:function(e,t,n,r,i){n==PROPERTY_COLOR?e.setColor(r):this._super(e,t,n,r,i)},onHandlePropTypeByte:function(e,t,n,r,i){n==PROPERTY_OPACITY?e.setOpacity(r):this._super(e,t,n,r,i)},onHandlePropTypeBlendFunc:function(e,t,n,r,i){n==PROPERTY_BLENDFUNC?e.setBlendFunc(r):this._super(e,t,n,r,i)}}),cc.LayerColorLoader.loader=function(){return new cc.LayerColorLoader};var PROPERTY_STARTCOLOR="startColor",PROPERTY_ENDCOLOR="endColor",PROPERTY_STARTOPACITY="startOpacity",PROPERTY_ENDOPACITY="endOpacity",PROPERTY_VECTOR="vector";cc.LayerGradientLoader=cc.LayerLoader.extend({_createCCNode:function(e,t){return cc.LayerGradient.create()},onHandlePropTypeColor3:function(e,t,n,r,i){n==PROPERTY_STARTCOLOR?e.setStartColor(r):n==PROPERTY_ENDCOLOR?e.setEndColor(r):this._super(e,t,n,r,i)},onHandlePropTypeByte:function(e,t,n,r,i){n==PROPERTY_STARTOPACITY?e.setStartOpacity(r):n==PROPERTY_ENDOPACITY?e.setEndOpacity(r):this._super(e,t,n,r,i)},onHandlePropTypePoint:function(e,t,n,r,i){n==PROPERTY_VECTOR?e.setVector(r):this._super(e,t,n,r,i)},onHandlePropTypeBlendFunc:function(e,t,n,r,i){n==PROPERTY_BLENDFUNC?e.setBlendFunc(r):this._super(e,t,n,r,i)}}),cc.LayerGradientLoader.loader=function(){return new cc.LayerGradientLoader},cc.MenuLoader=cc.LayerLoader.extend({_createCCNode:function(e,t){return cc.Menu.create()}}),cc.MenuLoader.loader=function(){return new cc.MenuLoader};var PROPERTY_BLOCK="block",PROPERTY_ISENABLED="isEnabled";cc.MenuItemLoader=cc.NodeLoader.extend({_createCCNode:function(e,t){return null},onHandlePropTypeBlock:function(e,t,n,r,i){n==PROPERTY_BLOCK?null!=r&&e.setTarget(r.selMenuHander,r.target):this._super(e,t,n,r,i)},onHandlePropTypeCheck:function(e,t,n,r,i){n==PROPERTY_ISENABLED?e.setEnabled(r):this._super(e,t,n,r,i)}});var PROPERTY_NORMALDISPLAYFRAME="normalSpriteFrame",PROPERTY_SELECTEDDISPLAYFRAME="selectedSpriteFrame",PROPERTY_DISABLEDDISPLAYFRAME="disabledSpriteFrame";cc.MenuItemImageLoader=cc.MenuItemLoader.extend({_createCCNode:function(e,t){return cc.MenuItemImage.create()},onHandlePropTypeSpriteFrame:function(e,t,n,r,i){n==PROPERTY_NORMALDISPLAYFRAME?r!=null&&e.setNormalSpriteFrame(r):n==PROPERTY_SELECTEDDISPLAYFRAME?r!=null&&e.setSelectedSpriteFrame(r):n==PROPERTY_DISABLEDDISPLAYFRAME?r!=null&&e.setDisabledSpriteFrame(r):this._super(e,t,n,r,i)}}),cc.MenuItemImageLoader.loader=function(){return new cc.MenuItemImageLoader};var PROPERTY_FONTNAME="fontName",PROPERTY_FONTSIZE="fontSize",PROPERTY_HORIZONTALALIGNMENT="horizontalAlignment",PROPERTY_VERTICALALIGNMENT="verticalAlignment",PROPERTY_STRING="string",PROPERTY_DIMENSIONS="dimensions";cc.LabelTTFLoader=cc.NodeLoader.extend({_createCCNode:function(e,t){return cc.LabelTTF.create()},onHandlePropTypeColor3:function(e,t,n,r,i){n==PROPERTY_COLOR?e.setColor(r):this._super(e,t,n,r,i)},onHandlePropTypeByte:function(e,t,n,r,i){n==PROPERTY_OPACITY?e.setOpacity(r):this._super(e,t,n,r,i)},onHandlePropTypeBlendFunc:function(e,t,n,r,i){n==PROPERTY_BLENDFUNC?e.setBlendFunc(r):this._super(pNode,pParent,n,r,i)},onHandlePropTypeFontTTF:function(e,t,n,r,i){n==PROPERTY_FONTNAME?e.setFontName(r):this._super(e,t,n,r,i)},onHandlePropTypeText:function(e,t,n,r,i){n==PROPERTY_STRING?e.setString(r):this._super(e,t,n,r,i)},onHandlePropTypeFloatScale:function(e,t,n,r,i){n==PROPERTY_FONTSIZE?e.setFontSize(r):this._super(e,t,n,r,i)},onHandlePropTypeIntegerLabeled:function(e,t,n,r,i){n==PROPERTY_HORIZONTALALIGNMENT?e.setHorizontalAlignment(r):n==PROPERTY_VERTICALALIGNMENT?e.setVerticalAlignment(r):this._super(e,t,n,r,i)},onHandlePropTypeSize:function(e,t,n,r,i){n==PROPERTY_DIMENSIONS?e.setDimensions(r):this._super(e,t,n,r,i)}}),cc.LabelTTFLoader.loader=function(){return new cc.LabelTTFLoader};var PROPERTY_FNTFILE="fntFile";cc.LabelBMFontLoader=cc.NodeLoader.extend({_createCCNode:function(e,t){return cc.LabelBMFont.create()},onHandlePropTypeColor3:function(e,t,n,r,i){n==PROPERTY_COLOR?e.setColor(r):this._super(e,t,n,r,i)},onHandlePropTypeByte:function(e,t,n,r,i){n==PROPERTY_OPACITY?e.setOpacity(r):this._super(e,t,n,r,i)},onHandlePropTypeBlendFunc:function(e,t,n,r,i){n==PROPERTY_BLENDFUNC?e.setBlendFunc(r):this._super(e,t,n,r,i)},onHandlePropTypeFntFile:function(e,t,n,r,i){n==PROPERTY_FNTFILE?e.setFntFile(r):this._super(e,t,n,r,i)},onHandlePropTypeText:function(e,t,n,r,i){n==PROPERTY_STRING?e.setString(r):this._super(e,t,n,r,i)}}),cc.LabelBMFontLoader.loader=function(){return new cc.LabelBMFontLoader};var PROPERTY_EMITERMODE="emitterMode",PROPERTY_POSVAR="posVar",PROPERTY_EMISSIONRATE="emissionRate",PROPERTY_DURATION="duration",PROPERTY_TOTALPARTICLES="totalParticles",PROPERTY_LIFE="life",PROPERTY_STARTSIZE="startSize",PROPERTY_ENDSIZE="endSize",PROPERTY_STARTSPIN="startSpin",PROPERTY_ENDSPIN="endSpin",PROPERTY_ANGLE="angle",PROPERTY_GRAVITY="gravity",PROPERTY_SPEED="speed",PROPERTY_TANGENTIALACCEL="tangentialAccel",PROPERTY_RADIALACCEL="radialAccel",PROPERTY_TEXTURE="texture",PROPERTY_STARTRADIUS="startRadius",PROPERTY_ENDRADIUS="endRadius",PROPERTY_ROTATEPERSECOND="rotatePerSecond";cc.ParticleSystemQuadLoader=cc.NodeLoader.extend({_createCCNode:function(e,t){return cc.ParticleSystemQuad.create()},onHandlePropTypeIntegerLabeled:function(e,t,n,r,i){n==PROPERTY_EMITERMODE?e.setEmitterMode(r):this._super(e,t,n,r,i)},onHandlePropTypePoint:function(e,t,n,r,i){n==PROPERTY_POSVAR?e.setPosVar(r):n==PROPERTY_GRAVITY?e.setGravity(r):this._super(e,t,n,r,i)},onHandlePropTypeFloat:function(e,t,n,r,i){n==PROPERTY_EMISSIONRATE?e.setEmissionRate(r):n==PROPERTY_DURATION?e.setDuration(r):this._super(e,t,n,r,i)},onHandlePropTypeInteger:function(e,t,n,r,i){n==PROPERTY_TOTALPARTICLES?e.setTotalParticles(r):this._super(e,t,n,r,i)},onHandlePropTypeFloatVar:function(e,t,n,r,i){n==PROPERTY_LIFE?(e.setLife(r[0]),e.setLifeVar(r[1])):n==PROPERTY_STARTSIZE?(e.setStartSize(r[0]),e.setStartSizeVar(r[1])):n==PROPERTY_ENDSIZE?(e.setEndSize(r[0]),e.setEndSizeVar(r[1])):n==PROPERTY_STARTSPIN?(e.setStartSpin(r[0]),e.setStartSpinVar(r[1])):n==PROPERTY_ENDSPIN?(e.setEndSpin(r[0]),e.setEndSpinVar(r[1])):n==PROPERTY_ANGLE?(e.setAngle(r[0]),e.setAngleVar(r[1])):n==PROPERTY_SPEED?(e.setSpeed(r[0]),e.setSpeedVar(r[1])):n==PROPERTY_TANGENTIALACCEL?(e.setTangentialAccel(r[0]),e.setTangentialAccelVar(r[1])):n==PROPERTY_RADIALACCEL?(e.setRadialAccel(r[0]),e.setRadialAccelVar(r[1])):n==PROPERTY_STARTRADIUS?(e.setStartRadius(r[0]),e.setStartRadiusVar(r[1])):n==PROPERTY_ENDRADIUS?(e.setEndRadius(r[0]),e.setEndRadiusVar(r[1])):n==PROPERTY_ROTATEPERSECOND?(e.setRotatePerSecond(r[0]),e.setRotatePerSecondVar(r[1])):this._super(e,t,n,r,i)},onHandlePropTypeColor4FVar:function(e,t,n,r,i){n==PROPERTY_STARTCOLOR?(e.setStartColor(r[0]),e.setStartColorVar(r[1])):n==PROPERTY_ENDCOLOR?(e.setEndColor(r[0]),e.setEndColorVar(r[1])):this._super(e,t,n,r,i)},onHandlePropTypeBlendFunc:function(e,t,n,r,i){n==PROPERTY_BLENDFUNC?e.setBlendFunc(r):this._super(e,t,n,r,i)},onHandlePropTypeTexture:function(e,t,n,r,i){n==PROPERTY_TEXTURE?e.setTexture(r):this._super(e,t,n,r,i)}}),cc.ParticleSystemQuadLoader.loader=function(){return new cc.ParticleSystemQuadLoader};cc.NodeLoaderLibrary=cc.Class.extend({_ccNodeLoaders:null,ctor:function(){this._ccNodeLoaders={}},registerDefaultCCNodeLoaders:function(){this.registerCCNodeLoader("CCNode",cc.NodeLoader.loader()),this.registerCCNodeLoader("CCLayer",cc.LayerLoader.loader()),this.registerCCNodeLoader("CCLayerColor",cc.LayerColorLoader.loader()),this.registerCCNodeLoader("CCLayerGradient",cc.LayerGradientLoader.loader()),this.registerCCNodeLoader("CCSprite",cc.SpriteLoader.loader()),this.registerCCNodeLoader("CCLabelBMFont",cc.LabelBMFontLoader.loader()),this.registerCCNodeLoader("CCLabelTTF",cc.LabelTTFLoader.loader()),this.registerCCNodeLoader("CCScale9Sprite",cc.Scale9SpriteLoader.loader()),this.registerCCNodeLoader("CCScrollView",cc.ScrollViewLoader.loader()),this.registerCCNodeLoader("CCBFile",cc.BuilderFileLoader.loader()),this.registerCCNodeLoader("CCMenu",cc.MenuLoader.loader()),this.registerCCNodeLoader("CCMenuItemImage",cc.MenuItemImageLoader.loader()),this.registerCCNodeLoader("CCControlButton",cc.ControlButtonLoader.loader()),this.registerCCNodeLoader("CCParticleSystemQuad",cc.ParticleSystemQuadLoader.loader())},registerCCNodeLoader:function(e,t){this._ccNodeLoaders[e]=t},unregisterCCNodeLoader:function(e){this._ccNodeLoaders.hasOwnProperty(e)&&delete this._ccNodeLoaders[e]},getCCNodeLoader:function(e){return this._ccNodeLoaders.hasOwnProperty(e)?this._ccNodeLoaders[e]:null},purge:function(e){if(e)for(var t in this._ccNodeLoaders)delete this._ccNodeLoaders[t];this._ccNodeLoaders={}}}),cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary=null,cc.NodeLoaderLibrary.library=function(){return new cc.NodeLoaderLibrary},cc.NodeLoaderLibrary.sharedCCNodeLoaderLibrary=function(){return cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary==null&&(cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary=new cc.NodeLoaderLibrary,cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary.registerDefaultCCNodeLoaders()),cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary},cc.NodeLoaderLibrary.purgeSharedCCNodeLoaderLibrary=function(){cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary=null},cc.NodeLoaderLibrary.newDefaultCCNodeLoaderLibrary=function(){var e=cc.NodeLoaderLibrary.library();return e.registerDefaultCCNodeLoaders(),e};var CCB_VERSION=5,CCB_PROPTYPE_POSITION=0,CCB_PROPTYPE_SIZE=1,CCB_PROPTYPE_POINT=2,CCB_PROPTYPE_POINTLOCK=3,CCB_PROPTYPE_SCALELOCK=4,CCB_PROPTYPE_DEGREES=5,CCB_PROPTYPE_INTEGER=6,CCB_PROPTYPE_FLOAT=7,CCB_PROPTYPE_FLOATVAR=8,CCB_PROPTYPE_CHECK=9,CCB_PROPTYPE_SPRITEFRAME=10,CCB_PROPTYPE_TEXTURE=11,CCB_PROPTYPE_BYTE=12,CCB_PROPTYPE_COLOR3=13,CCB_PROPTYPE_COLOR4VAR=14,CCB_PROPTYPE_FLIP=15,CCB_PROPTYPE_BLENDMODE=16,CCB_PROPTYPE_FNTFILE=17,CCB_PROPTYPE_TEXT=18,CCB_PROPTYPE_FONTTTF=19,CCB_PROPTYPE_INTEGERLABELED=20,CCB_PROPTYPE_BLOCK=21,CCB_PROPTYPE_ANIMATION=22,CCB_PROPTYPE_CCBFILE=23,CCB_PROPTYPE_STRING=24,CCB_PROPTYPE_BLOCKCCCONTROL=25,CCB_PROPTYPE_FLOATSCALE=26,CCB_PROPTYPE_FLOATXY=27,CCB_FLOAT0=0,CCB_FLOAT1=1,CCB_FLOAT_MINUS1=2,CCB_FLOAT05=3,CCB_FLOAT_INTEGER=4,CCB_FLOAT_FULL=5,CCB_PLATFORM_ALL=0,CCB_PLATFORM_IOS=1,CCB_PLATFORM_MAC=2,CCB_TARGETTYPE_NONE=0,CCB_TARGETTYPE_DOCUMENTROOT=1,CCB_TARGETTYPE_OWNER=2,CCB_KEYFRAME_EASING_INSTANT=0,CCB_KEYFRAME_EASING_LINEAR=1,CCB_KEYFRAME_EASING_CUBIC_IN=2,CCB_KEYFRAME_EASING_CUBIC_OUT=3,CCB_KEYFRAME_EASING_CUBIC_INOUT=4,CCB_KEYFRAME_EASING_ELASTIC_IN=5,CCB_KEYFRAME_EASING_ELASTIC_OUT=6,CCB_KEYFRAME_EASING_ELASTIC_INOUT=7,CCB_KEYFRAME_EASING_BOUNCE_IN=8,CCB_KEYFRAME_EASING_BOUNCE_OUT=9,CCB_KEYFRAME_EASING_BOUNCE_INOUT=10,CCB_KEYFRAME_EASING_BACK_IN=11,CCB_KEYFRAME_EASING_BACK_OUT=12,CCB_KEYFRAME_EASING_BACK_INOUT=13,CCB_POSITIONTYPE_RELATIVE_BOTTOM_LEFT=0,CCB_POSITIONTYPE_RELATIVE_TOP_LEFT=1,CCB_POSITIONTYPE_RELATIVE_TOP_RIGHT=2,CCB_POSITIONTYPE_RELATIVE_BOTTOM_RIGHT=3,CCB_POSITIONTYPE_PERCENT=4,CCB_POSITIONTYPE_MULTIPLY_RESOLUTION=5,CCB_SIZETYPE_ABSOLUTE=0,CCB_SIZETYPE_PERCENT=1,CCB_SIZETYPE_RELATIVE_CONTAINER=2,CCB_SIZETYPE_HORIZONTAL_PERCENT=3,CCB_SIZETYPE_VERTICAL_PERCENT=4,CCB_SIZETYPE_MULTIPLY_RESOLUTION=5,CCB_SCALETYPE_ABSOLUTE=0,CCB_SCALETYPE_MULTIPLY_RESOLUTION=1,_ccbGlobalContext=_ccbGlobalContext||window;cc.BuilderFile=cc.Node.extend({_ccbFileNode:null,getCCBFileNode:function(){return this._ccbFileNode},setCCBFileNode:function(e){this._ccbFileNode=e}}),cc.BuilderFile.create=function(){return new cc.BuilderFile},cc.BuilderReader=cc.Class.extend({_jsControlled:!1,_data:null,_ccbRootPath:"",_bytes:0,_currentByte:0,_currentBit:0,_stringCache:null,_loadedSpriteSheets:null,_owner:null,_actionManager:null,_animationManagers:null,_animatedProps:null,_ccNodeLoaderLibrary:null,_ccNodeLoaderListener:null,_ccbMemberVariableAssigner:null,_ccbSelectorResolver:null,_ownerOutletNames:null,_ownerOutletNodes:null,_nodesWithAnimationManagers:null,_animationManagerForNodes:null,_ownerCallbackNames:null,_ownerCallbackNodes:null,_hasScriptingOwner:!1,ctor:function(e,t,n,r){this._stringCache=[],this._loadedSpriteSheets=[],this._currentBit=-1,this._currentByte=-1;if(arguments.length!=0)if(e instanceof cc.BuilderReader){var i=e;this._loadedSpriteSheets=i._loadedSpriteSheets,this._ccNodeLoaderLibrary=i._ccNodeLoaderLibrary,this._ccbMemberVariableAssigner=i._ccbMemberVariableAssigner,this._ccbSelectorResolver=i._ccbSelectorResolver,this._ccNodeLoaderListener=i._ccNodeLoaderListener,this._ownerCallbackNames=i._ownerCallbackNames,this._ownerCallbackNodes=i._ownerCallbackNodes,this._ownerOutletNames=i._ownerOutletNames,this._ownerOutletNodes=i._ownerOutletNodes,this._ccbRootPath=i._ccbRootPath}else this._ccNodeLoaderLibrary=e,this._ccbMemberVariableAssigner=t,this._ccbSelectorResolver=n,this._ccNodeLoaderListener=r},getCCBRootPath:function(){return this._ccbRootPath},setCCBRootPath:function(e){this._ccbRootPath=e},initWithData:function(e,t){return this._actionManager=new cc.BuilderAnimationManager,this._data=e,this._bytes=e.length,this._currentBit=0,this._currentByte=0,this._owner=t,this._actionManager.setRootContainerSize(cc.Director.getInstance().getWinSize()),!0},readNodeGraphFromFile:function(e,t,n,r){n==null?n=cc.Director.getInstance().getWinSize():n instanceof cc.BuilderAnimationManager&&(r=n,n=cc.Director.getInstance().getWinSize());var i=cc.FileUtils.getInstance().fullPathFromRelativePath(e),s=cc.FileUtils.getInstance().getByteArrayFromFile(i);return this.readNodeGraphFromData(s,t,n,r)},readNodeGraphFromData:function(e,t,n,r){this.initWithData(e,t),this._actionManager.setRootContainerSize(n),this._actionManager.setOwner(t),this._ownerOutletNames=[],this._ownerOutletNodes=[],this._ownerCallbackNames=[],this._ownerCallbackNodes=[],this._animationManagers=new cc._Dictionary;var i=this.readFileWithCleanUp(!0);i&&this._actionManager.getAutoPlaySequenceId()!=-1&&this._actionManager.runAnimations(this._actionManager.getAutoPlaySequenceId(),0);if(this._jsControlled){this._nodesWithAnimationManagers=[],this._animationManagerForNodes=[];var s=this._animationManagers.allKeys();for(var o=0;o<s.length;o++)this._nodesWithAnimationManagers.push(s[o]),this._animationManagerForNodes.push(this._animationManagers.objectForKey(s[o]))}return i},createSceneWithNodeGraphFromFile:function(e,t,n,r){var i=this.readNodeGraphFromFile(e,t,n,r),s=cc.Scene.create();return s.addChild(i),s},getCCBMemberVariableAssigner:function(){return this._ccbMemberVariableAssigner},getCCBSelectorResolver:function(){return this._ccbSelectorResolver},getAnimationManager:function(){return this._actionManager},setAnimationManager:function(e){this._actionManager=e},getAnimatedProperties:function(){return this._animatedProps},getLoadedSpriteSheet:function(){return this._loadedSpriteSheets},getOwner:function(){return this._owner},readInt:function(e){var t=0;while(!this._getBit())t++;var n=0;for(var r=t-1;r>=0;r--)this._getBit()&&(n|=1<<r);n|=1<<t;var i;if(e){var s=n%2;s?i=0|n/2:i=0|-n/2}else i=n-1;return this._alignBits(),i},readByte:function(){var e=this._data[this._currentByte];return this._currentByte++,e},readBool:function(){return 0!=this.readByte()},readFloat:function(){var e=this.readByte();switch(e){case CCB_FLOAT0:return 0;case CCB_FLOAT1:return 1;case CCB_FLOAT_MINUS1:return-1;case CCB_FLOAT05:return.5;case CCB_FLOAT_INTEGER:return this.readInt(!0);default:var t=this._decodeFloat(23,8);return t}},_decodeFloat:function(e,t){var n=e+t+1,r=n>>3;this._checkSize(n);var i=Math.pow(2,t-1)-1,s=this._readBitsOnly(e+t,1,r),o=this._readBitsOnly(e,t,r),u=0,a=2,f=0;do{var l=this._readByteOnly(++f,r),c=e%8||8,h=1<<c;while(h>>=1)l&h&&(u+=1/a),a*=2}while(e-=c);return this._currentByte+=r,o==(i<<1)+1?u?NaN:s?-Infinity:+Infinity:(1+s*-2)*(o||u?o?Math.pow(2,o-i)*(1+u):Math.pow(2,-i+1)*u:0)},_readBitsOnly:function(e,t,n){var r=(e+t)%8,i=e%8,s=n-(e>>3)-1,o=n+(-(e+t)>>3),u=s-o,a=this._readByteOnly(s,n)>>i&(1<<(u?8-i:t))-1;u&&r&&(a+=(this._readByteOnly(o++,n)&(1<<r)-1)<<(u--<<3)-i);while(u)a+=this._shl(this._readByteOnly(o++,n),(u--<<3)-i);return a},_readByteOnly:function(e,t){return this._data[this._currentByte+t-e-1]},_shl:function(e,t){for(++t;--t;e=((e%=2147483647+1)&1073741824)==1073741824?e*2:(e-1073741824)*2+2147483647+1);return e},_checkSize:function(e){if(!(this._currentByte+Math.ceil(e/8)<this._data.length))throw new Error("Index out of bound")},readCachedString:function(){return this._stringCache[this.readInt(!1)]},isJSControlled:function(){return this._jsControlled},getOwnerCallbackNames:function(){return this._ownerCallbackNames},getOwnerCallbackNodes:function(){return this._ownerCallbackNodes},getOwnerOutletNames:function(){return this._ownerOutletNames},getOwnerOutletNodes:function(){return this._ownerOutletNodes},getNodesWithAnimationManagers:function(){return this._nodesWithAnimationManagers},getAnimationManagersForNodes:function(){return this._animationManagerForNodes},getAnimationManagers:function(){return this._animationManagers},setAnimationManagers:function(e){this._animationManagers=e},addOwnerCallbackName:function(e){this._ownerCallbackNames.push(e)},addOwnerCallbackNode:function(e){this._ownerCallbackNodes.push(e)},addDocumentCallbackName:function(e){this._actionManager.addDocumentCallbackName(e)},addDocumentCallbackNode:function(e){this._actionManager.addDocumentCallbackNode(e)},readFileWithCleanUp:function(e){if(!this._readHeader())return null;if(!this._readStringCache())return null;if(!this._readSequences())return null;var t=this._readNodeGraph();return this._animationManagers.setObject(this._actionManager,t),e&&this._cleanUpNodeGraph(t),t},_cleanUpNodeGraph:function(e){e.setUserObject(null);var t=e.getChildren();for(var n=0;n<t.length;n++)this._cleanUpNodeGraph(t[n])},_readCallbackKeyframesForSeq:function(e){var t=this.readInt(!1);if(!t)return!0;var n=new cc.BuilderSequenceProperty;for(var r=0;r<t;r++){var i=this.readFloat(),s=this.readCachedString(),o=this.readInt(!1),u=[s,o],a=new cc.BuilderKeyframe;a.setTime(i),a.setValue(u),this._jsControlled&&this._actionManager.getKeyframeCallbacks().push(o+":"+s),n.getKeyframes().push(a)}return e.setCallbackChannel(n),!0},_readSoundKeyframesForSeq:function(e){var t=this.readInt(!1);if(!t)return!0;var n=new cc.BuilderSequenceProperty;for(var r=0;r<t;r++){var i=this.readFloat(),s=this.readCachedString(),o=this.readFloat(),u=this.readFloat(),a=this.readFloat(),f=[s,o,u,a],l=new cc.BuilderKeyframe;l.setTime(i),l.setValue(f),n.getKeyframes().push(l)}return e.setSoundChannel(n),!0},_readSequences:function(){var e=this._actionManager.getSequences(),t=this.readInt(!1);for(var n=0;n<t;n++){var r=new cc.BuilderSequence;r.setDuration(this.readFloat()),r.setName(this.readCachedString()),r.setSequenceId(this.readInt(!1)),r.setChainedSequenceId(this.readInt(!0));if(!this._readCallbackKeyframesForSeq(r))return!1;if(!this._readSoundKeyframesForSeq(r))return!1;e.push(r)}return this._actionManager.setAutoPlaySequenceId(this.readInt(!0)),!0},readKeyframe:function(e){var t=new cc.BuilderKeyframe;t.setTime(this.readFloat());var n=this.readInt(!1),r=0,i=null;if(n===CCB_KEYFRAME_EASING_CUBIC_IN||n===CCB_KEYFRAME_EASING_CUBIC_OUT||n===CCB_KEYFRAME_EASING_CUBIC_INOUT||n===CCB_KEYFRAME_EASING_ELASTIC_IN||n===CCB_KEYFRAME_EASING_ELASTIC_OUT||n===CCB_KEYFRAME_EASING_ELASTIC_INOUT)r=this.readFloat();t.setEasingType(n),t.setEasingOpt(r);if(e==CCB_PROPTYPE_CHECK)i=this.readBool();else if(e==CCB_PROPTYPE_BYTE)i=this.readByte();else if(e==CCB_PROPTYPE_COLOR3){var s=cc.c3(this.readByte(),this.readByte(),this.readByte());i=cc.Color3BWapper.create(s)}else if(e==CCB_PROPTYPE_FLOATXY)i=[this.readFloat(),this.readFloat()];else if(e==CCB_PROPTYPE_DEGREES)i=this.readFloat();else if(e==CCB_PROPTYPE_SCALELOCK||e==CCB_PROPTYPE_POSITION||e==CCB_PROPTYPE_FLOATXY)i=[this.readFloat(),this.readFloat()];else if(e==CCB_PROPTYPE_SPRITEFRAME){var o=this.readCachedString(),u=this.readCachedString();if(o==""){u=this._ccbRootPath+u;var a=cc.TextureCache.getInstance().addImage(u),f;cc.renderContextType==cc.CANVAS?f=cc.RectMake(0,0,a.width,a.height):f=cc.RectMake(0,0,a.getContentSize().width,a.getContentSize().height),i=cc.SpriteFrame.createWithTexture(a,f)}else{o=this._ccbRootPath+o;var l=cc.SpriteFrameCache.getInstance();this._loadedSpriteSheets.indexOf(o)==-1&&(l.addSpriteFrames(o),this._loadedSpriteSheets.push(o)),i=l.getSpriteFrame(u)}}return t.setValue(i),t},_readHeader:function(){if(this._data==null)return!1;var e=this._readStringFromBytes(this._currentByte,4,!0);this._currentByte+=4;if(e!="ccbi")return!1;var t=this.readInt(!1);return t!=CCB_VERSION?(cc.log("WARNING! Incompatible ccbi file version (file: "+t+" reader: "+CCB_VERSION+")"),!1):(this._jsControlled=this.readBool(),this._actionManager._jsControlled=this._jsControlled,!0)},_readStringFromBytes:function(e,t,n){n=n||!1;var r="",i;if(n)for(i=t-1;i>=0;i--)r+=String.fromCharCode(this._data[this._currentByte+i]);else for(i=0;i<t;i++)r+=String.fromCharCode(this._data[this._currentByte+i]);return r},_readStringCache:function(){var e=this.readInt(!1);for(var t=0;t<e;t++)this._readStringCacheEntry();return!0},_readStringCacheEntry:function(){var e=this.readByte(),t=this.readByte(),n=e<<8|t,r="";for(var i=0;i<n;i++){var s=this._data[this._currentByte+i].toString("16").toUpperCase();s=s.length>1?s:"0"+s,r+="%"+s}r=decodeURIComponent(r),this._currentByte+=n,this._stringCache.push(r)},_readNodeGraph:function(e){var t=this.readCachedString(),n;this._jsControlled&&(n=this.readCachedString());var r=this.readInt(!1),i;r!=CCB_TARGETTYPE_NONE&&(i=this.readCachedString());var s=this._ccNodeLoaderLibrary.getCCNodeLoader(t);s||(s=this._ccNodeLoaderLibrary.getCCNodeLoader("CCNode"));var o=s.loadCCNode(e,this);this._actionManager.getRootNode()||this._actionManager.setRootNode(o),this._jsControlled&&o==this._actionManager.getRootNode()&&this._actionManager.setDocumentControllerName(n);var u=new cc._Dictionary;this._animatedProps=[];var a,f=this.readInt(!1);for(a=0;a<f;++a){var l=this.readInt(!1),c=new cc._Dictionary,h=this.readInt(!1);for(var p=0;p<h;++p){var d=new cc.BuilderSequenceProperty;d.setName(this.readCachedString()),d.setType(this.readInt(!1)),this._animatedProps.push(d.getName());var v=this.readInt(!1);for(var m=0;m<v;++m){var g=this.readKeyframe(d.getType());d.getKeyframes().push(g)}c.setObject(d,d.getName())}u.setObject(c,l)}u.count()>0&&this._actionManager.addNode(o,u),s.parseProperties(o,e,this);if(o instanceof cc.BuilderFile){var y=o.getCCBFileNode();y.setPosition(o.getPosition()),y.setRotation(o.getRotation()),y.setScale(o.getScale()),y.setTag(o.getTag()),y.setVisible(!0),y.ignoreAnchorPointForPosition(o.isIgnoreAnchorPointForPosition()),o.setCCBFileNode(null),o=y}if(r!=CCB_TARGETTYPE_NONE)if(!this._jsControlled){var b=null;r==CCB_TARGETTYPE_DOCUMENTROOT?b=this._actionManager.getRootNode():r==CCB_TARGETTYPE_OWNER&&(b=this._owner);if(b!=null){var w=!1;b!=null&&b.onAssignCCBMemberVariable&&(w=b.onAssignCCBMemberVariable(b,i,o)),!w&&this._ccbMemberVariableAssigner!=null&&this._ccbMemberVariableAssigner.onAssignCCBMemberVariable&&this._ccbMemberVariableAssigner.onAssignCCBMemberVariable(b,i,o)}}else r==CCB_TARGETTYPE_DOCUMENTROOT?(this._actionManager.addDocumentOutletName(i),this._actionManager.addDocumentOutletNode(o)):(this._ownerOutletNames.push(i),this._ownerOutletNodes.push(o));if(s.getCustomProperties().length>0){var E=!1;if(!this._jsControlled){var b=o;if(b!=null&&b.onAssignCCBCustomProperty!=null){var S=s.getCustomProperties(),x=S.allKeys();for(a=0;a<x.length;a++){var T=S.objectForKey(x[a]);E=b.onAssignCCBCustomProperty(b,x[a],T),!E&&this._ccbMemberVariableAssigner!=null&&this._ccbMemberVariableAssigner.onAssignCCBCustomProperty!=null&&(E=this._ccbMemberVariableAssigner.onAssignCCBCustomProperty(b,x[a],T))}}}}this._animatedProps=null;var N=this.readInt(!1);for(a=0;a<N;a++){var C=this._readNodeGraph(o);o.addChild(C)}return o!=null&&o.onNodeLoaded?o.onNodeLoaded(o,s):this._ccNodeLoaderListener!=null&&this._ccNodeLoaderListener.onNodeLoaded(o,s),o},_getBit:function(){var e=(this._data[this._currentByte]&1<<this._currentBit)!=0;return this._currentBit++,this._currentBit>=8&&(this._currentBit=0,this._currentByte++),e},_alignBits:function(){this._currentBit&&(this._currentBit=0,this._currentByte++)},_readUTF8:function(){}}),cc.BuilderReader._ccbResolutionScale=1,cc.BuilderReader.setResolutionScale=function(e){cc.BuilderReader._ccbResolutionScale=e},cc.BuilderReader.getResolutionScale=function(){return cc.BuilderReader._ccbResolutionScale},cc.BuilderReader.loadAsScene=function(e,t,n,r){r=r||cc.BuilderReader.getResourcePath();var i=cc.BuilderReader.load(e,t,n,r),s=cc.Scene.create();return s.addChild(i),s},cc.BuilderReader.load=function(e,t,n,r){r=r||cc.BuilderReader.getResourcePath();var i=new cc.BuilderReader(cc.NodeLoaderLibrary.newDefaultCCNodeLoaderLibrary());i.setCCBRootPath(r),e.toLowerCase().lastIndexOf(".ccbi")!=e.length-5&&(e+=".ccbi");var s=i.readNodeGraphFromFile(e,t,n),o,u,a,f,l;if(t){var c=i.getOwnerCallbackNames(),h=i.getOwnerCallbackNodes();for(o=0;o<c.length;o++)u=c[o],a=h[o],a.setCallback(t[u],t);var p=i.getOwnerOutletNames(),d=i.getOwnerOutletNodes();for(o=0;o<p.length;o++)f=p[o],l=d[o],t[f]=l}var v=i.getNodesWithAnimationManagers(),m=i.getAnimationManagersForNodes();if(!v||!m)return s;for(o=0;o<v.length;o++){var g=v[o],y=m[o],b;g.animationManager=y;var w=y.getDocumentControllerName();if(!w)continue;var E=new _ccbGlobalContext[w];E.controllerName=w,g.controller=E,E.rootNode=g;var S=y.getDocumentCallbackNames(),x=y.getDocumentCallbackNodes();for(b=0;b<S.length;b++)u=S[b],a=x[b],a.setCallback(E[u],E);var T=y.getDocumentOutletNames(),N=y.getDocumentOutletNodes();for(b=0;b<T.length;b++)f=T[b],l=N[b],E[f]=l;E.onDidLoadFromCCB&&typeof E.onDidLoadFromCCB=="function"&&E.onDidLoadFromCCB();var C=y.getKeyframeCallbacks();for(b=0;b<C.length;b++){var k=C[b].split(":"),L=k[0],u=k[1];if(L==1){var A=cc.CallFunc.create(E[u],E);y.setCallFunc(A,C[b])}else if(L==2&&t){var A=cc.CallFunc.create(t[u],t);y.setCallFunc(A,C[b])}}}return s},cc.BuilderReader._resourcePath="",cc.BuilderReader.setResourcePath=function(e){cc.BuilderReader._resourcePath=e},cc.BuilderReader.getResourcePath=function(){return cc.BuilderReader._resourcePath},cc.BuilderReader.lastPathComponent=function(e){var t=e.lastIndexOf("/");return t!=-1?e.substring(t+1,e.length-t):e},cc.BuilderReader.deletePathExtension=function(e){var t=e.lastIndexOf(".");return t!=-1?e.substring(0,t):e},cc.BuilderReader.toLowerCase=function(e){return e.toLowerCase()},cc.BuilderReader.endsWith=function(e,t){return e.length>=t.length?e.lastIndexOf(t)==0:!1},cc.BuilderReader.concat=function(e,t){return e+t};cc.INT_VALUE=0,cc.FLOAT_VALUE=1,cc.POINTER_VALUE=2,cc.BOOL_VALUE=3,cc.UNSIGNEDCHAR_VALUE=4,cc.Color3BWapper=cc.Class.extend({_color:null,ctor:function(){this._color=new cc.Color3B(0,0,0)},getColor:function(){return this._color}}),cc.Color3BWapper.create=function(e){var t=new cc.Color3BWapper;return t&&(t._color.r=e.r,t._color.g=e.g,t._color.b=e.b),t},cc.BuilderValue=cc.Class.extend({_value:null,_type:0,getIntValue:function(){},getFloatValue:function(){},getBoolValue:function(){},getByteValue:function(){},getPointer:function(){},getValue:function(){return this._value}}),cc.BuilderValue.create=function(e){var t=new cc.BuilderValue;return t&&typeof e=="number",t};cc.BuilderKeyframe=cc.Class.extend({_value:null,_time:0,_easingType:0,_easingOpt:0,getValue:function(){return this._value},setValue:function(e){this._value=e},getTime:function(){return this._time},setTime:function(e){this._time=e},getEasingType:function(){return this._easingType},setEasingType:function(e){this._easingType=e},getEasingOpt:function(){return this._easingOpt},setEasingOpt:function(e){this._easingOpt=e}});cc.BuilderSequence=cc.Class.extend({_duration:0,_name:"",_sequenceId:0,_chainedSequenceId:0,_callbackChannel:null,_soundChannel:null,ctor:function(){this._name=""},getDuration:function(){return this._duration},setDuration:function(e){this._duration=e},getName:function(){return this._name},setName:function(e){this._name=e},getSequenceId:function(){return this._sequenceId},setSequenceId:function(e){this._sequenceId=e},getChainedSequenceId:function(){return this._chainedSequenceId},setChainedSequenceId:function(e){this._chainedSequenceId=e},getCallbackChannel:function(){return this._callbackChannel},setCallbackChannel:function(e){this._callbackChannel=e},getSoundChannel:function(){return this._soundChannel},setSoundChannel:function(e){this._soundChannel=e}}),cc.BuilderSequenceProperty=cc.Class.extend({_name:null,_type:0,_keyFrames:null,ctor:function(){this.init()},init:function(){this._keyFrames=[],this._name=""},getName:function(){return this._name},setName:function(e){this._name=e},getType:function(){return this._type},setType:function(e){this._type=e},getKeyframes:function(){return this._keyFrames}});cc.getAbsolutePosition=function(e,t,n,r){var i=cc.p(0,0);if(t==CCB_POSITIONTYPE_RELATIVE_BOTTOM_LEFT)i=e;else if(t==CCB_POSITIONTYPE_RELATIVE_TOP_LEFT)i.x=e.x,i.y=n.height-e.y;else if(t==CCB_POSITIONTYPE_RELATIVE_TOP_RIGHT)i.x=n.width-e.x,i.y=n.height-e.y;else if(t==CCB_POSITIONTYPE_RELATIVE_BOTTOM_RIGHT)i.x=n.width-e.x,i.y=e.y;else if(t==CCB_POSITIONTYPE_PERCENT)i.x=n.width*e.x/100,i.y=n.height*e.y/100;else if(t==CCB_POSITIONTYPE_MULTIPLY_RESOLUTION){var s=cc.BuilderReader.getResolutionScale();i.x=e.x*s,i.y=e.y*s}return i},cc.setRelativeScale=function(e,t,n,r,i){cc.Assert(e,"pNode should not be null");if(r==CCB_POSITIONTYPE_MULTIPLY_RESOLUTION){var s=cc.BuilderReader.getResolutionScale();t*=s,n*=s}e.setScaleX(t),e.setScaleY(n)};cc.BuilderAnimationManagerDelegate=cc.Class.extend({completedAnimationSequenceNamed:function(e){}}),cc.BuilderAnimationManager=cc.Class.extend({_sequences:null,_nodeSequences:null,_baseValues:null,_autoPlaySequenceId:0,_rootNode:null,_owner:null,_rootContainerSize:null,_delegate:null,_runningSequence:null,_documentOutletNames:null,_documentOutletNodes:null,_documentCallbackNames:null,_documentCallbackNodes:null,_documentControllerName:"",_lastCompletedSequenceName:"",_keyframeCallbacks:null,_keyframeCallFuncs:null,_animationCompleteCallbackFunc:null,_target:null,_jsControlled:!1,ctor:function(){this._rootContainerSize=cc.size(0,0),this.init()},init:function(){return this._sequences=[],this._nodeSequences=new cc._Dictionary,this._baseValues=new cc._Dictionary,this._documentOutletNames=[],this._documentOutletNodes=[],this._documentCallbackNames=[],this._documentCallbackNodes=[],this._keyframeCallbacks=[],this._keyframeCallFuncs={},!0},getSequences:function(){return this._sequences},setSequences:function(e){this._sequences=e},getAutoPlaySequenceId:function(){return this._autoPlaySequenceId},setAutoPlaySequenceId:function(e){this._autoPlaySequenceId=e},getRootNode:function(){return this._rootNode},setRootNode:function(e){this._rootNode=e},getOwner:function(){return this._owner},setOwner:function(e){this._owner=e},addDocumentCallbackNode:function(e){this._documentCallbackNodes.push(e)},addDocumentCallbackName:function(e){this._documentCallbackNames.push(e)},addDocumentOutletNode:function(e){this._documentOutletNodes.push(e)},addDocumentOutletName:function(e){this._documentOutletNames.push(e)},setDocumentControllerName:function(e){this._documentControllerName=e},getDocumentControllerName:function(){return this._documentControllerName},getDocumentCallbackNames:function(){return this._documentCallbackNames},getDocumentCallbackNodes:function(){return this._documentCallbackNodes},getDocumentOutletNames:function(){return this._documentOutletNames},getDocumentOutletNodes:function(){return this._documentOutletNodes},getLastCompletedSequenceName:function(){return this._lastCompletedSequenceName},getKeyframeCallbacks:function(){return this._keyframeCallbacks},getRootContainerSize:function(){return this._rootContainerSize},setRootContainerSize:function(e){this._rootContainerSize=cc.size(e.width,e.height)},getDelegate:function(){return this._delegate},setDelegate:function(e){this._delegate=e},getRunningSequenceName:function(){return this._runningSequence.getName()},getContainerSize:function(e){return e?e.getContentSize():this._rootContainerSize},addNode:function(e,t){this._nodeSequences.setObject(t,e)},setBaseValue:function(e,t,n){var r=this._baseValues.objectForKey(t);r||(r=new cc._Dictionary,this._baseValues.setObject(r,t)),r.setObject(e,n)},moveAnimationsFromNode:function(e,t){var n=this._baseValues.objectForKey(e);n!=null&&(this._baseValues.setObject(n,t),this._baseValues.removeObjectForKey(e));var r=this._nodeSequences.objectForKey(e);r!=null&&(this._nodeSequences.setObject(r,t),this._nodeSequences.removeObjectForKey(e))},getActionForCallbackChannel:function(e){var t=0,n=[],r=e.getKeyframes(),i=r.length;for(var s=0;s<i;++s){var o=r[s],u=o.getTime()-t;t=o.getTime(),u>0&&n.push(cc.DelayTime.create(u));var a=o.getValue(),f=a[0],l=a[1];if(this._jsControlled){var c=l+":"+f,h=this._keyframeCallFuncs[c];h!=null&&n.push(h)}else{var p;l==CCB_TARGETTYPE_DOCUMENTROOT?p=this._rootNode:l==CCB_TARGETTYPE_OWNER&&(p=this._owner);if(p!=null)if(f.length>0){var d=0,v=p;p.onResolveCCBCCCallFuncSelector!=null&&(d=v.onResolveCCBCCCallFuncSelector(p,f)),d==0?cc.log("Skipping selector '"+f+"' since no CCBSelectorResolver is present."):n.push(cc.CallFunc.create(d,p))}else cc.log("Unexpected empty selector.")}}return n.length<1?null:cc.Sequence.create(n)},getActionForSoundChannel:function(e){var t=0,n=[],r=e.getKeyframes(),i=r.length;for(var s=0;s<i;++s){var o=r[s],u=o.getTime()-t;t=o.getTime(),u>0&&n.push(cc.DelayTime.create(u));var a=o.getValue(),f=cc.BuilderReader.getResourcePath()+a[0],l=parseFloat(a[1]),c=parseFloat(a[2]),h=parseFloat(a[3]);n.push(cc.BuilderSoundEffect.create(f,l,c,h))}return n.length<1?null:cc.Sequence.create(n)},runAnimationsForSequenceNamed:function(e){this.runAnimations(e)},runAnimations:function(e,t){t=t||0;var n;typeof e=="string"?n=this._getSequenceId(e):n=e,cc.Assert(n!=-1,"Sequence id couldn't be found"),this._rootNode.stopAllActions();var r=this._nodeSequences.allKeys();for(var i=0;i<r.length;i++){var s=r[i];s.stopAllActions();var o=this._nodeSequences.objectForKey(s),u=o.objectForKey(n),a,f=[];if(u){var l=u.allKeys();for(a=0;a<l.length;a++){var c=l[a],h=u.objectForKey(c);f.push(c),this._setFirstFrame(s,h,t),this._runAction(s,h,t)}}var p=this._baseValues.objectForKey(s);if(p){var d=p.allKeys();for(a=0;a<d.length;a++){var v=d[a];if(f.indexOf(v)==-1){var m=p.objectForKey(v);m!=null&&this._setAnimatedProperty(v,s,m,t)}}}}var g=this._getSequence(n),y=cc.Sequence.create(cc.DelayTime.create(g.getDuration()+t),cc.CallFunc.create(this._sequenceCompleted,this));this._rootNode.runAction(y);if(g.getCallbackChannel()){var b=this.getActionForCallbackChannel(g.getCallbackChannel());b&&this._rootNode.runAction(b)}if(g.getSoundChannel()){var b=this.getActionForSoundChannel(g.getSoundChannel());b&&this._rootNode.runAction(b)}this._runningSequence=this._getSequence(n)},setAnimationCompletedCallback:function(e,t){this._target=e,this._animationCompleteCallbackFunc=t},setCompletedAnimationCallback:function(e,t){this.setAnimationCompletedCallback(e,t)},setCallFunc:function(e,t){this._keyframeCallFuncs[t]=e},debug:function(){},_getBaseValue:function(e,t){var n=this._baseValues.objectForKey(e);return n?n.objectForKey(t):null},_getSequenceId:function(e){var t=null;for(var n=0;n<this._sequences.length;n++){t=this._sequences[n];if(t&&t.getName()==e)return t.getSequenceId()}return-1},_getSequence:function(e){var t=null;for(var n=0;n<this._sequences.length;n++){t=this._sequences[n];if(t&&t.getSequenceId()===e)return t}return null},_getAction:function(e,t,n,r){var i=t.getTime()-(e?e.getTime():0),s,o,u,a,f;if(n==="rotation")return cc.BuilderRotateTo.create(i,t.getValue());if(n==="rotationX")return cc.BuilderRotateXTo.create(i,t.getValue());if(n==="rotationY")return cc.BuilderRotateYTo.create(i,t.getValue());if(n==="opacity")return cc.FadeTo.create(i,t.getValue());if(n==="color"){var l=t.getValue().getColor();return cc.TintTo.create(i,l.r,l.g,l.b)}if(n==="visible"){var c=t.getValue();return c?cc.Sequence.create(cc.DelayTime.create(i),cc.Show.create()):cc.Sequence.create(cc.DelayTime.create(i),cc.Hide.create())}if(n==="displayFrame")return cc.Sequence.create(cc.DelayTime.create(i),cc.BuilderSetSpriteFrame.create(t.getValue()));if(n==="position"){s=this._getBaseValue(r,n),o=s[2],u=t.getValue(),a=u[0],f=u[1];var h=this.getContainerSize(r.getParent()),p=cc.getAbsolutePosition(cc.p(a,f),o,h,n);return cc.MoveTo.create(i,p)}if(n==="scale"){s=this._getBaseValue(r,n),o=s[2],u=t.getValue(),a=u[0],f=u[1];if(o==CCB_SCALETYPE_MULTIPLY_RESOLUTION)var d=cc.BuilderReader.getResolutionScale();return cc.ScaleTo.create(i,a,f)}return n==="skew"?(u=t.getValue(),a=u[0],f=u[1],cc.SkewTo.create(i,a,f)):(cc.log("BuilderReader: Failed to create animation for property: "+n),null)},_setAnimatedProperty:function(e,t,n,r){if(r>0){var i=new cc.BuilderKeyframe;i.setValue(n),i.setTime(r),i.setEasingType(CCB_KEYFRAME_EASING_LINEAR);var s=this._getAction(null,i,e,t);t.runAction(s)}else{var o,u,a,f;e==="position"?(o=this._getBaseValue(t,e),u=o[2],a=n[0],f=n[1],t.setPosition(cc.getAbsolutePosition(cc.p(a,f),u,this.getContainerSize(t.getParent()),e))):e==="scale"?(o=this._getBaseValue(t,e),u=o[2],a=n[0],f=n[1],cc.setRelativeScale(t,a,f,u,e)):e==="skew"?(o=this._getBaseValue(t,e),u=o[2],a=n[0],f=n[1],t.setSkewX(a),t.setSkewY(f)):e==="rotation"?t.setRotation(n):e==="opacity"?t.setOpacity(n):e==="displayFrame"?t.setDisplayFrame(n):e==="color"?t.setColor(n.getColor()):e==="visible"?(n=n||!1,t.setVisible(n)):(cc.log("unsupported property name is "+e),cc.Assert(!1,"unsupported property now"))}},_setFirstFrame:function(e,t,n){var r=t.getKeyframes();if(r.length==0){var i=this._getBaseValue(e,t.getName());cc.Assert(i,"No baseValue found for property"),this._setAnimatedProperty(t.getName(),e,i,n)}else{var s=r[0];this._setAnimatedProperty(t.getName(),e,s.getValue(),n)}},_getEaseAction:function(e,t,n){return t===CCB_KEYFRAME_EASING_LINEAR||t===CCB_KEYFRAME_EASING_INSTANT?e:t===CCB_KEYFRAME_EASING_CUBIC_IN?cc.EaseIn.create(e,n):t===CCB_KEYFRAME_EASING_CUBIC_OUT?cc.EaseOut.create(e,n):t===CCB_KEYFRAME_EASING_CUBIC_INOUT?cc.EaseInOut.create(e,n):t===CCB_KEYFRAME_EASING_BACK_IN?cc.EaseBackIn.create(e):t===CCB_KEYFRAME_EASING_BACK_OUT?cc.EaseBackOut.create(e):t===CCB_KEYFRAME_EASING_BACK_INOUT?cc.EaseBackInOut.create(e):t===CCB_KEYFRAME_EASING_BOUNCE_IN?cc.EaseBounceIn.create(e):t===CCB_KEYFRAME_EASING_BOUNCE_OUT?cc.EaseBounceOut.create(e):t===CCB_KEYFRAME_EASING_BOUNCE_INOUT?cc.EaseBounceInOut.create(e):t===CCB_KEYFRAME_EASING_ELASTIC_IN?cc.EaseElasticIn.create(e,n):t===CCB_KEYFRAME_EASING_ELASTIC_OUT?cc.EaseElasticOut.create(e,n):t===CCB_KEYFRAME_EASING_ELASTIC_INOUT?cc.EaseElasticInOut.create(e,n):(cc.log("BuilderReader: Unkown easing type "+t),e)},_runAction:function(e,t,n){var r=t.getKeyframes(),i=r.length;if(i>1){var s=[],o=r[0],u=o.getTime()+n;u>0&&s.push(cc.DelayTime.create(u));for(var a=0;a<i-1;++a){var f=r[a],l=r[a+1],c=this._getAction(f,l,t.getName(),e);c&&(c=this._getEaseAction(c,f.getEasingType(),f.getEasingOpt()),s.push(c))}var h=cc.Sequence.create(s);e.runAction(h)}},_sequenceCompleted:function(){this._lastCompletedSequenceName!=this._runningSequence.getName()&&(this._lastCompletedSequenceName=this._runningSequence.getName()),this._delegate&&this._delegate.completedAnimationSequenceNamed(this._runningSequence.getName()),this._target&&this._animationCompleteCallbackFunc&&this._animationCompleteCallbackFunc.call(this._target);var e=this._runningSequence.getChainedSequenceId();this._runningSequence=null,e!=-1&&this.runAnimations(e,0)}}),cc.BuilderSetSpriteFrame=cc.ActionInstant.extend({_spriteFrame:null,initWithSpriteFrame:function(e){return this._spriteFrame=e,!0},update:function(e){this._target.setDisplayFrame(this._spriteFrame)}}),cc.BuilderSetSpriteFrame.create=function(e){var t=new cc.BuilderSetSpriteFrame;return t&&t.initWithSpriteFrame(e)?t:null},cc.BuilderRotateTo=cc.ActionInterval.extend({_startAngle:0,_dstAngle:0,_diffAngle:0,initWithDuration:function(e,t){return this._super(e)?(this._dstAngle=t,!0):!1},update:function(e){this._target.setRotation(this._startAngle+this._diffAngle*e)},startWithTarget:function(e){this._super(e),this._startAngle=this._target.getRotation(),this._diffAngle=this._dstAngle-this._startAngle}}),cc.BuilderRotateTo.create=function(e,t){var n=new cc.BuilderRotateTo;return n&&n.initWithDuration(e,t)?n:null},cc.BuilderRotateXTo=cc.ActionInterval.extend({}),cc.BuilderRotateXTo.create=function(e,t){return cc.Assert(!1,"rotationX not implemented in cocos2d-html5"),null},cc.BuilderRotateYTo=cc.ActionInterval.extend({}),cc.BuilderRotateYTo.create=function(e,t){return cc.Assert(!1,"rotationY not implemented in cocos2d-html5"),null},cc.BuilderSoundEffect=cc.ActionInstant.extend({init:function(e){return this._file=e,!0},update:function(e){cc.AudioEngine.getInstance().playEffect(this._file)}}),cc.BuilderSoundEffect.create=function(e,t,n,r){var i=new cc.BuilderSoundEffect;return i&&i.init(e)?i:null};cc.KEYBOARD_RETURNTYPE_DEFAULT=0,cc.KEYBOARD_RETURNTYPE_DONE=1,cc.KEYBOARD_RETURNTYPE_SEND=2,cc.KEYBOARD_RETURNTYPE_SEARCH=3,cc.KEYBOARD_RETURNTYPE_GO=4,cc.EDITBOX_INPUT_MODE_ANY=0,cc.EDITBOX_INPUT_MODE_EMAILADDR=1,cc.EDITBOX_INPUT_MODE_NUMERIC=2,cc.EDITBOX_INPUT_MODE_PHONENUMBER=3,cc.EDITBOX_INPUT_MODE_URL=4,cc.EDITBOX_INPUT_MODE_DECIMAL=5,cc.EDITBOX_INPUT_MODE_SINGLELINE=6,cc.EDITBOX_INPUT_FLAG_PASSWORD=0,cc.EDITBOX_INPUT_FLAG_SENSITIVE=1,cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_WORD=2,cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_SENTENCE=3,cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_ALL_CHARACTERS=4,cc.EditBoxDelegate=cc.Class.extend({editBoxEditingDidBegin:function(e){},editBoxEditingDidEnd:function(e){},editBoxTextChanged:function(e,t){},editBoxReturn:function(e){}}),cc.EditBox=cc.ControlButton.extend({_domInputSprite:null,_delegate:null,_editBoxInputMode:cc.EDITBOX_INPUT_MODE_ANY,_editBoxInputFlag:cc.EDITBOX_INPUT_FLAG_SENSITIVE,_keyboardReturnType:cc.KEYBOARD_RETURNTYPE_DEFAULT,_text:"",_placeholderText:"",_textColor:null,_placeholderColor:null,_maxLength:50,_adjustHeight:18,_edTxt:null,_edFontSize:14,_edFontName:"Arial",_placeholderFontName:"",_placeholderFontSize:14,_tooltip:!1,ctor:function(e){this._super(),this._textColor=cc.WHITE,this._placeholderColor=cc.GRAY,this._domInputSprite=new cc.Sprite,this._domInputSprite.setColor(cc.BLUE),this._domInputSprite.setContentSize(cc.size(e.width-10,e.height-10)),this._domInputSprite.draw=function(){},this.addChild(this._domInputSprite);var t=this;this._edTxt=document.createElement("input"),this._edTxt.type="text",this._edTxt.style.fontSize=this._edFontSize+"px",this._edTxt.style.color="#000000",this._edTxt.style.border=0,this._edTxt.style.background="transparent",this._edTxt.style.paddingLeft="2px",this._edTxt.style.width="100%",this._edTxt.style.height="100%",this._edTxt.style.active=0,this._edTxt.style.outline="medium",this._edTxt.addEventListener("input",function(){t._delegate&&t._delegate.editBoxTextChanged&&t._delegate.editBoxTextChanged(t,this.value)}),this._edTxt.addEventListener("keypress",function(e){e.keyCode===cc.KEY.enter&&(e.stopPropagation(),e.preventDefault(),cc.canvas.focus())}),this._edTxt.addEventListener("focus",function(){this.value==t._placeholderText&&(this.value="",this.style.color=cc.convertColor3BtoHexString(t._textColor)),t._delegate&&t._delegate.editBoxEditingDidBegin&&t._delegate.editBoxEditingDidBegin(t)}),this._edTxt.addEventListener("blur",function(){this.value==""&&(this.value=t._placeholderText,this.style.color=cc.convertColor3BtoHexString(t._placeholderColor)),t._delegate&&t._delegate.editBoxEditingDidEnd&&t._delegate.editBoxEditingDidEnd(t),t._delegate&&t._delegate.editBoxReturn&&t._delegate.editBoxReturn(t)}),cc.DOM.convert(this._domInputSprite),this._domInputSprite.dom.appendChild(this._edTxt),this._domInputSprite.dom.showTooltipDiv=!1,this._domInputSprite.dom.className="",this._domInputSprite.canvas.remove()},setFont:function(e,t){this._edFontSize=t,this._edFontName=e,this._edTxt.value==this._placeholderText&&this._setFontToEditBox()},_setFontToEditBox:function(){this._edTxt.style.fontFamily=this._placeholderFontName,this._edTxt.style.fontSize=this._placeholderFontSize},setText:function(e){e!=null&&(e==""?(this._edTxt.value=this._placeholderText,this._edTxt.style.color=cc.convertColor3BtoHexString(this._placeholderColor)):(this._edTxt.value=e,this._edTxt.style.color=cc.convertColor3BtoHexString(this._textColor)))},setFontColor:function(e){this._textColor=e,this._edTxt.value!=this._placeholderText&&(this._edTxt.style.color=cc.convertColor3BtoHexString(e))},setMaxLength:function(e){!isNaN(e)&&e>0&&(this._maxLength=e,this._edTxt.maxLength=e)},getMaxLength:function(){return this._maxLength},setPlaceHolder:function(e){if(e!=null){var t=this._placeholderText;this._placeholderText=e,this._edTxt.value==t&&(this._edTxt.value=e,this._edTxt.style.color=cc.convertColor3BtoHexString(this._placeholderColor),this._setPlaceholderFontToEditText())}},setPlaceholderFont:function(e,t){this._placeholderFontName=e,this._placeholderFontSize=t,this._edTxt.value==this._placeholderText&&this._setPlaceholderFontToEditText()},_setPlaceholderFontToEditText:function(){this._edTxt.style.fontFamily=this._placeholderFontName,this._edTxt.style.fontSize=this._placeholderFontSize},setPlaceholderFontColor:function(e){this._placeholderColor=e,this._edTxt.value==this._placeholderText&&(this._edTxt.style.color=cc.convertColor3BtoHexString(e))},setInputFlag:function(e){this._editBoxInputFlag=e,e==cc.EDITBOX_INPUT_FLAG_PASSWORD?this._edTxt.type="password":this._edTxt.type="text"},getText:function(){return this._edTxt.value},initWithSizeAndBackgroundSprite:function(e,t){return this.initWithBackgroundSprite(t)?(this._domInputSprite.setPosition(cc.p(3,3)),this.setZoomOnTouchDown(!1),this.setPreferredSize(e),this.setPosition(cc.p(0,0)),this.addTargetWithActionForControlEvent(this,this.touchDownAction,cc.CONTROL_EVENT_TOUCH_UP_INSIDE),!0):!1},setDelegate:function(e){this._delegate=e},getPlaceHolder:function(){return this._placeholderText},setInputMode:function(e){this._editBoxInputMode=e},setReturnType:function(e){this._keyboardReturnType=e},keyboardWillShow:function(e){var t=cc.EditBox.getRect(this);t.origin.y-=4;if(!t.intersectsRect(e.end)){cc.log("needn't to adjust view layout.");return}this._adjustHeight=e.end.getMaxY()-t.getMinY()},keyboardDidShow:function(e){},keyboardWillHide:function(e){},keyboardDidHide:function(e){},touchDownAction:function(e,t){},initWithBackgroundColor:function(e,t){this._edWidth=e.width,this.dom.style.width=this._edWidth.toString()+"px",this._edHeight=e.height,this.dom.style.height=this._edHeight.toString()+"px",this.dom.style.backgroundColor=cc.convertColor3BtoHexString(t)}}),cc.EditBox.getRect=function(e){var t=e.getContentSize(),n=cc.RectMake(0,0,t.width,t.height);return cc.RectApplyAffineTransform(n,e.nodeToWorldTransform())},cc.EditBox.create=function(e,t,n,r){var i=new cc.EditBox(e);return t instanceof cc.Color3B?i.setBackgroundColor(t):i.initWithSizeAndBackgroundSprite(e,t)&&(n&&i.setBackgroundSpriteForState(n,cc.CONTROL_STATE_HIGHLIGHTED),r&&i.setBackgroundSpriteForState(r,cc.CONTROL_STATE_DISABLED)),i};